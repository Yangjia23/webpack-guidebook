(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[41],{"0Owb":function(e,n,l){"use strict";function a(){return a=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var l=arguments[n];for(var a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a])}return e},a.apply(this,arguments)}l.d(n,"a",(function(){return a}))},JJXW:function(e,n,l){e.exports=l.p+"static/chrome-devices-inspect.5ddd130d.jpeg"},"K+nK":function(e,n){function l(e){return e&&e.__esModule?e:{default:e}}e.exports=l},ShLd:function(e,n,l){e.exports=l.p+"static/console-compiler.6ef45e6f.png"},SiHa:function(e,n,l){"use strict";l.r(n);var a=l("0Owb"),t=l("q1tI"),c=l.n(t),o=(l("B2uJ"),l("+su7"),l("qOys")),r=l.n(o),i=l("5Yjd"),m=l.n(i),s=c.a.memo((function(){var e=l("K+nK"),n=e(l("q1tI")),a=e(l("j9jy")),t=function(){return n["default"].createElement("img",{alt:"Webpack\u6267\u884c\u6d41\u7a0b",src:a["default"],width:640})};return n["default"].createElement(t)})),p=c.a.memo((function(){var e=l("K+nK"),n=e(l("q1tI")),a=e(l("ShLd")),t=function(){return n["default"].createElement("img",{alt:"Compiler\u5bf9\u8c61\u5b9e\u4f8b",src:a["default"],width:720})};return n["default"].createElement(t)})),u=c.a.memo((function(){var e=l("K+nK"),n=e(l("q1tI")),a=e(l("YTC0")),t=function(){return n["default"].createElement("img",{alt:"Compilation",src:a["default"],width:720})};return n["default"].createElement(t)})),d=c.a.memo((function(){var e=l("K+nK"),n=e(l("q1tI")),a=e(l("JJXW")),t=function(){return n["default"].createElement("img",{alt:"\u6d4f\u89c8\u5668\u8c03\u8bd5\u6a21\u5f0f",src:a["default"],width:640})};return n["default"].createElement(t)})),E=c.a.memo((function(){var e=l("K+nK"),n=e(l("q1tI")),a=e(l("eKZL")),t=function(){return n["default"].createElement("img",{alt:"\u4ee3\u7801\u65ad\u70b9",src:a["default"],width:640})};return n["default"].createElement(t)}));n["default"]=function(){return c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"markdown"},c.a.createElement("h1",{id:"plugin-\u673a\u5236"},c.a.createElement("a",{"aria-hidden":"true",href:"#plugin-\u673a\u5236"},c.a.createElement("span",{className:"icon icon-link"})),"Plugin \u673a\u5236"),c.a.createElement("p",null,"\u901a\u8fc7\u63d2\u4ef6\u6211\u4eec\u53ef\u4ee5\u6269\u5c55 webpack\uff0c\u5728\u5408\u9002\u7684\u65f6\u673a\u901a\u8fc7 Webpack \u63d0\u4f9b\u7684 API \u6539\u53d8\u8f93\u51fa\u7ed3\u679c\uff0c\u4f7f Webpack \u53ef\u4ee5\u6267\u884c\u66f4\u5e7f\u6cdb\u7684\u4efb\u52a1\uff0c\u62e5\u6709\u66f4\u5f3a\u7684\u6784\u5efa\u80fd\u529b\u3002"),c.a.createElement("p",null,"\u672c\u6587\u5c06\u5c1d\u8bd5\u63a2\u7d22 Webpack \u63d2\u4ef6\u7684\u5de5\u4f5c\u6d41\u7a0b\uff0c\u8fdb\u800c\u53bb\u63ed\u79d8\u5b83\u7684\u5de5\u4f5c\u539f\u7406\u3002\u540c\u65f6\u9700\u8981\u4f60\u5bf9 Webpack \u5e95\u5c42\u548c\u6784\u5efa\u6d41\u7a0b\u7684\u4e00\u4e9b\u4e1c\u897f\u6709\u4e00\u5b9a\u7684\u4e86\u89e3\u3002"),c.a.createElement("p",null,"\u60f3\u8981\u4e86\u89e3 webpack \u7684\u63d2\u4ef6\u7684\u673a\u5236\uff0c\u9700\u8981\u5f04\u660e\u767d\u4ee5\u4e0b\u51e0\u4e2a\u77e5\u8bc6\u70b9\uff1a"),c.a.createElement("ol",null,c.a.createElement("li",null,"\u4e00\u4e2a\u7b80\u5355\u7684\u63d2\u4ef6\u7684\u6784\u6210"),c.a.createElement("li",null,"Webpack \u6784\u5efa\u6d41\u7a0b"),c.a.createElement("li",null,"Tapable \u662f\u5982\u4f55\u628a\u5404\u4e2a\u63d2\u4ef6\u4e32\u8054\u5230\u4e00\u8d77\u7684"),c.a.createElement("li",null,c.a.createElement("code",null,"compiler")," \u4ee5\u53ca ",c.a.createElement("code",null,"compilation")," \u5bf9\u8c61\u7684\u4f7f\u7528\u4ee5\u53ca\u5b83\u4eec\u5bf9\u5e94\u7684\u4e8b\u4ef6\u94a9\u5b50\u3002")),c.a.createElement("h2",{id:"\u63d2\u4ef6\u7684\u57fa\u672c\u7ed3\u6784"},c.a.createElement("a",{"aria-hidden":"true",href:"#\u63d2\u4ef6\u7684\u57fa\u672c\u7ed3\u6784"},c.a.createElement("span",{className:"icon icon-link"})),"\u63d2\u4ef6\u7684\u57fa\u672c\u7ed3\u6784"),c.a.createElement("p",null,c.a.createElement("code",null,"plugins")," \u662f\u53ef\u4ee5\u7528\u81ea\u8eab\u539f\u578b\u65b9\u6cd5 ",c.a.createElement("code",null,"apply")," \u6765\u5b9e\u4f8b\u5316\u7684\u5bf9\u8c61\u3002",c.a.createElement("code",null,"apply")," \u53ea\u5728\u5b89\u88c5\u63d2\u4ef6\u88ab Webpack \u7684 ",c.a.createElement("code",null,"compiler")," \u6267\u884c\u4e00\u6b21\u3002",c.a.createElement("code",null,"apply")," \u65b9\u6cd5\u4f20\u5165\u4e00\u4e2a webpck ",c.a.createElement("code",null,"compiler")," \u7684\u5f15\u7528\uff0c\u6765\u8bbf\u95ee\u7f16\u8bd1\u5668\u56de\u8c03\u3002"),c.a.createElement(r.a,{code:"class HelloPlugin {\n  // \u5728\u6784\u9020\u51fd\u6570\u4e2d\u83b7\u53d6\u7528\u6237\u7ed9\u8be5\u63d2\u4ef6\u4f20\u5165\u7684\u914d\u7f6e\n  constructor(options) {\n    // ...\n  }\n\n  // Webpack \u4f1a\u8c03\u7528 HelloPlugin \u5b9e\u4f8b\u7684 apply \u65b9\u6cd5\u7ed9\u63d2\u4ef6\u5b9e\u4f8b\u4f20\u5165 compiler \u5bf9\u8c61\n  apply(compiler) {\n    // \u5728 emit \u9636\u6bb5\u63d2\u5165\u94a9\u5b50\u51fd\u6570\uff0c\u7528\u4e8e\u7279\u5b9a\u65f6\u673a\u5904\u7406\u989d\u5916\u7684\u903b\u8f91\n    compiler.hooks.emit.tap('HelloPlugin', compilation => {\n      // \u5728\u529f\u80fd\u6d41\u7a0b\u5b8c\u6210\u540e\u53ef\u4ee5\u8c03\u7528 Webpack \u63d0\u4f9b\u7684\u56de\u8c03\u51fd\u6570\n    });\n\n    // \u5982\u679c\u4e8b\u4ef6\u662f\u5f02\u6b65\u7684\uff0c\u4f1a\u5e26\u4e24\u4e2a\u53c2\u6570\uff0c\u7b2c\u4e8c\u4e2a\u53c2\u6570\u4e3a\u56de\u8c03\u51fd\u6570\uff0c\u5728\u63d2\u4ef6\u5904\u7406\u5b8c\u6210\u4efb\u52a1\u65f6\u9700\u8981\u8c03\u7528\u56de\u8c03\u51fd\u6570\u901a\u77e5 Webpack\uff0c\u624d\u4f1a\u8fdb\u5165\u4e0b\u4e00\u4e2a\u5904\u7406\u6d41\u7a0b\n    compiler.plugin('emit', function(compilation, callback) {\n      // \u652f\u6301\u5904\u7406\u903b\u8f91\n      // \u5904\u7406\u5b8c\u6bd5\u540e\u6267\u884c callback \u4ee5\u901a\u77e5 Webpack\n      // \u5982\u679c\u4e0d\u6267\u884c callback\uff0c\u8fd0\u884c\u6d41\u7a0b\u5c06\u4f1a\u4e00\u81f4\u5361\u5728\u8fd9\u4e0d\u5f80\u4e0b\u6267\u884c\n      callback();\n    });\n  }\n}\n\nmodule.exports = HelloPlugin;\n",lang:"js"}),c.a.createElement("p",null,"\u4f7f\u7528\u63d2\u4ef6\u65f6\uff0c\u53ea\u9700\u8981\u5c06\u5b83\u7684\u5b9e\u4f8b\u653e\u5230 Webpack \u7684 Plugins \u6570\u7ec4\u914d\u7f6e\u4e2d\uff1a"),c.a.createElement(r.a,{code:"const HelloPlugin = require('./hello-plugin.js');\n\nmodule.exports = {\n  plugins: [new HelloPlugin({ options: true })],\n};\n",lang:"js"}),c.a.createElement("p",null,"\u5148\u6765\u5206\u6790\u4ee5\u4e0b Webpack Plugin \u7684\u5de5\u4f5c\u539f\u7406\uff1a"),c.a.createElement("ol",null,c.a.createElement("li",null,"\u8bfb\u53d6\u914d\u7f6e\u7684\u8fc7\u7a0b\u4e2d\u4f1a\u5148\u6267\u884c ",c.a.createElement("code",null,"new HelloPlugin(options)")," \u521d\u59cb\u5316\u4e00\u4e2a ",c.a.createElement("code",null,"HelloPlugin")," \u83b7\u5f97\u5176\u5b9e\u4f8b"),c.a.createElement("li",null,"\u521d\u59cb\u5316 ",c.a.createElement("code",null,"compiler")," \u5bf9\u8c61\u540e\u8c03\u7528 ",c.a.createElement("code",null,"HelloPlugin.apply(compiler)")," \u7ed9\u63d2\u4ef6\u5b9e\u4f8b\u4f20\u5165 ",c.a.createElement("code",null,"compiler")," \u5bf9\u8c61"),c.a.createElement("li",null,"\u63d2\u4ef6\u5b9e\u4f8b\u5728\u83b7\u53d6\u5230 ",c.a.createElement("code",null,"compiler")," \u5bf9\u8c61\u540e\uff0c\u5c31\u53ef\u4ee5\u901a\u8fc7 ",c.a.createElement("code",null,"compiler.plugin(\u4e8b\u4ef6\u540d\u79f0, \u56de\u8c03\u51fd\u6570)")," \u76d1\u542c\u5230 Webpack \u5e7f\u64ad\u51fa\u6765\u7684\u4e8b\u4ef6\uff0c\u5e76\u4e14\u53ef\u4ee5\u901a\u8fc7 ",c.a.createElement("code",null,"compiler")," \u5bf9\u8c61\u53bb\u64cd\u4f5c Webpack")),c.a.createElement("h2",{id:"\u6784\u5efa\u6d41\u7a0b"},c.a.createElement("a",{"aria-hidden":"true",href:"#\u6784\u5efa\u6d41\u7a0b"},c.a.createElement("span",{className:"icon icon-link"})),"\u6784\u5efa\u6d41\u7a0b"),c.a.createElement("p",null,"\u5728\u7f16\u5199\u63d2\u4ef6\u4e4b\u524d\uff0c\u8fd8\u9700\u8981\u4e86\u89e3\u4ee5\u4e0b Webpack \u7684\u6784\u5efa\u6d41\u7a0b\uff0c\u4ee5\u4fbf\u5728\u5408\u9002\u7684\u65f6\u673a\u63d2\u5165\u5408\u9002\u7684\u63d2\u4ef6\u903b\u8f91\u3002"),c.a.createElement("p",null,"Webpack \u7684\u57fa\u672c\u6784\u5efa\u6d41\u7a0b\u5982\u4e0b\uff1a"),c.a.createElement("ol",null,c.a.createElement("li",null,"\u6821\u9a8c\u914d\u7f6e\u6587\u4ef6\uff1a\u8bfb\u53d6\u547d\u4ee4\u884c\u4f20\u5165\u6216\u8005 ",c.a.createElement("code",null,"webpack.config.js")," \u6587\u4ef6\uff0c\u521d\u59cb\u5316\u672c\u6b21\u6784\u5efa\u7684\u914d\u7f6e\u53c2\u6570"),c.a.createElement("li",null,"\u751f\u6210 ",c.a.createElement("code",null,"Compiler")," \u5bf9\u8c61\uff1a\u6267\u884c\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u63d2\u4ef6\u5b9e\u4f8b\u5316\u8bed\u53e5 ",c.a.createElement("code",null,"new MyWebpackPlugin()"),"\uff0c\u4e3a Webpack \u4e8b\u4ef6\u6d41\u6302\u4e0a\u81ea\u5b9a\u4ee5 Hooks"),c.a.createElement("li",null,"\u8fdb\u5165 ",c.a.createElement("code",null,"entryOption")," \u9636\u6bb5\uff1aWebpack \u5f00\u59cb\u8bfb\u53d6\u914d\u7f6e\u7684 Entries\uff0c\u9012\u5f52\u904d\u5386\u6240\u6709\u7684\u5165\u53e3\u6587\u4ef6"),c.a.createElement("li",null,c.a.createElement("code",null,"run/watch"),"\uff1a\u5982\u679c\u8fd0\u884c\u5728 ",c.a.createElement("code",null,"watch")," \u6a21\u5f0f\u5219\u6267\u884c ",c.a.createElement("code",null,"watch")," \u65b9\u6cd5\uff0c\u5426\u5219\u6267\u884c ",c.a.createElement("code",null,"run")," \u65b9\u6cd5"),c.a.createElement("li",null,c.a.createElement("code",null,"compilation"),"\uff1a\u521b\u5efa ",c.a.createElement("code",null,"Compilation")," \u5bf9\u8c61\u56de\u8c03 ",c.a.createElement("code",null,"compilation")," \u76f8\u5173\u94a9\u5b50\uff0c\u4f9d\u6b21\u8fdb\u5165\u6bcf\u4e2a\u5165\u53e3\u6587\u4ef6\uff08",c.a.createElement("code",null,"entry"),"\uff09\uff0c\u4f7f\u7528 loader \u5bf9\u6587\u4ef6\u8fdb\u884c\u7f16\u8bd1\u3002\u901a\u8fc7 ",c.a.createElement("code",null,"compilation")," \u53ef\u4ee5\u8bfb\u53d6\u5230 ",c.a.createElement("code",null,"module")," \u7684 ",c.a.createElement("code",null,"resource"),"\uff08\u8d44\u6e90\u8def\u5f84\uff09\u3001",c.a.createElement("code",null,"loaders"),"\uff08\u4f7f\u7528\u5230\u7684 loader\uff09\u7b49\u4fe1\u606f\u3002\u518d\u5c06\u7f16\u8bd1\u597d\u7684\u6587\u4ef6\u5185\u5bb9\u4f7f\u7528 ",c.a.createElement("code",null,"acorn")," \u89e3\u6790\u751f\u6210 AST \u9759\u6001\u8bed\u6cd5\u6811\u3002\u7136\u540e\u9012\u5f52\u3001\u91cd\u590d\u7684\u6267\u884c\u8fd9\u4e2a\u8fc7\u7a0b\uff0c\u6240\u6709\u6a21\u5757\u548c\u4f9d\u8d56\u5206\u6790\u5b8c\u6210\u540e\uff0c\u6267\u884c ",c.a.createElement("code",null,"compilation")," \u7684 ",c.a.createElement("code",null,"seal")," \u65b9\u6cd5\u5bf9\u6bcf\u4e2a Chunk \u8fdb\u884c\u6574\u7406\u3001\u4f18\u5316\u3001\u5c01\u88c5 ",c.a.createElement("code",null,"__webpack_require__")," \u6765\u6a21\u62df\u6a21\u5757\u5316\u64cd\u4f5c"),c.a.createElement("li",null,c.a.createElement("code",null,"emit"),"\uff1a\u6240\u6709\u6587\u4ef6\u7684\u7f16\u8bd1\u53ca\u8f6c\u5316\u90fd\u5df2\u7ecf\u5b8c\u6210\uff0c\u5305\u542b\u4e86\u6700\u7ec8\u8f93\u51fa\u7684\u8d44\u6e90\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u4f20\u5165\u4e8b\u4ef6\u56de\u8c03\u7684 ",c.a.createElement("code",null,"compilation.assets")," \u4e0a\u62ff\u5230\u6240\u9700\u6570\u636e\uff0c\u5176\u4e2d\u5305\u62ec\u5373\u5c06\u8f93\u51fa\u7684\u8d44\u6e90\u3001\u4ee3\u7801\u5757 Chunk \u7b49\u4fe1\u606f")),c.a.createElement(r.a,{code:"// \u4fee\u6539\u6216\u6dfb\u52a0\u8d44\u6e90\ncompilation.assets['net-file.js'] = {\n  source() {\n    return 'var a=1';\n  },\n  size() {\n    return this.source().length;\n  },\n};\n",lang:"js"}),c.a.createElement("ol",{start:"7"},c.a.createElement("li",null,c.a.createElement("code",null,"afterEmit"),"\uff1a\u6587\u4ef6\u5df2\u7ecf\u5199\u5165\u78c1\u76d8\u5b8c\u6210"),c.a.createElement("li",null,c.a.createElement("code",null,"done"),"\uff1a\u5b8c\u6210\u7f16\u8bd1"))),c.a.createElement(m.a,Object(a["a"])({source:{jsx:"import React from 'react';\nimport img from '../../assets/principle-analysis/webpack-compile-workflow.jpeg';\n\nexport default () => <img alt=\"Webpack\u6267\u884c\u6d41\u7a0b\" src={img} width={640} />;"}},{inline:!0,dependencies:{},files:{}}),c.a.createElement(s,null)),c.a.createElement("div",{className:"markdown"},c.a.createElement("p",null,c.a.createElement("a",{href:"https://blog.didiyun.com/index.php/2019/03/01/webpack/",target:"_blank",rel:"noopener noreferrer"},"Webpack \u7f16\u8bd1\u6d41\u7a0b\u56fe",c.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg","aria-hidden":!0,x:"0px",y:"0px",viewBox:"0 0 100 100",width:"15",height:"15",className:"__dumi-default-external-link-icon"},c.a.createElement("path",{fill:"currentColor",d:"M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"}),c.a.createElement("polygon",{fill:"currentColor",points:"45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"})))),c.a.createElement("h2",{id:"\u7406\u89e3\u4e8b\u4ef6\u6d41\u673a\u5236-tapable"},c.a.createElement("a",{"aria-hidden":"true",href:"#\u7406\u89e3\u4e8b\u4ef6\u6d41\u673a\u5236-tapable"},c.a.createElement("span",{className:"icon icon-link"})),"\u7406\u89e3\u4e8b\u4ef6\u6d41\u673a\u5236 Tapable"),c.a.createElement("p",null,"Webpack \u672c\u8d28\u4e0a\u662f\u4e00\u79cd\u4e8b\u4ef6\u6d41\u7684\u673a\u5236\uff0c\u5b83\u7684\u5de5\u4f5c\u6d41\u7a0b\u5c31\u662f\u5c06\u5404\u4e2a\u63d2\u4ef6\u4e32\u8054\u8d77\u6765\uff0c\u800c\u5b9e\u73b0\u8fd9\u4e00\u5207\u7684\u6838\u5fc3\u5c31\u662f Tapable\u3002"),c.a.createElement("p",null,"Webpack \u7684 Tapable \u4e8b\u4ef6\u6d41\u673a\u5236\u4fdd\u8bc1\u4e86\u63d2\u4ef6\u7684\u6709\u5e8f\u6027\uff0c\u5c06\u5404\u4e2a\u63d2\u4ef6\u4e32\u8054\u8d77\u6765\uff0cWebpack \u5728\u8fd0\u884c\u8fc7\u7a0b\u4e2d\u4f1a\u5e7f\u64ad\u4e8b\u4ef6\uff0c\u63d2\u4ef6\u53ea\u9700\u8981\u76d1\u542c\u5b83\u6240\u5173\u5fc3\u7684\u4e8b\u4ef6\uff0c\u5c31\u80fd\u5047\u5982\u5230\u8fd9\u6761 Webpack \u673a\u5236\u4e2d\uff0c\u53bb\u6539\u53d8 Webpack \u7684\u8fd0\u4f5c\uff0c\u4f7f\u5f97\u6574\u4e2a\u7cfb\u7edf\u6269\u5c55\u6027\u826f\u597d\u3002"),c.a.createElement("p",null,c.a.createElement("code",null,"Tapable")," \u4e5f\u662f\u4e00\u4e2a\u5c0f\u578b\u7684 library\uff0c\u662f Webpack \u7684\u6838\u5fc3\u5de5\u5177\u3002\u7c7b\u4f3c\u4e8e Node \u4e2d\u7684 ",c.a.createElement("code",null,"events")," \u5e93\uff0c\u6838\u5fc3\u539f\u7406\u5c31\u662f\u4e00\u4e2a\u8ba2\u9605\u53d1\u5e03\u6a21\u5f0f\u3002\u4f5c\u7528\u662f\u63d0\u4f9b\u7c7b\u4f3c\u7684\u63d2\u4ef6\u63a5\u53e3\u3002"),c.a.createElement("p",null,"Webpack \u4e2d\u6700\u6838\u5fc3\u7684 ",c.a.createElement("strong",null,"\u8d1f\u8d23\u7f16\u8bd1\u7684 Compiler")," \u548c ",c.a.createElement("strong",null,"\u8d1f\u8d23 bundles \u7684 Compilation")," \u90fd\u662f ",c.a.createElement("code",null,"Tapable")," \u7684\u5b9e\u4f8b\uff0c\u53ef\u4ee5\u76f4\u63a5\u5728 Compiler \u548c Compilation \u5bf9\u8c61\u4e0a\u5e7f\u64ad\u548c\u76d1\u542c\u4e8b\u4ef6\uff0c\u65b9\u6cd5\u5982\u4e0b\uff1a"),c.a.createElement(r.a,{code:"/**\n * \u5e7f\u64ad\u4e8b\u4ef6\n * event-name \u4e3a\u4e8b\u4ef6\u540d\u79f0\uff0c\u6ce8\u610f\u4e0d\u8981\u548c\u73b0\u6709\u7684\u4e8b\u4ef6\u91cd\u540d\n */\ncompiler.apply('event-name', params);\ncompilation.apply('event-name', params);\n\n/**\n * \u76d1\u542c\u4e8b\u4ef6\n */\ncompiler.plugin('event-name', function(params) {});\ncompilation.plugin('event-name', function(params) {});\n",lang:"js"}),c.a.createElement("p",null,c.a.createElement("code",null,"Tapable")," \u7c7b\u66b4\u9732\u4e86 ",c.a.createElement("code",null,"tap"),"\u3001",c.a.createElement("code",null,"tapAsync")," \u548c ",c.a.createElement("code",null,"tapPromise")," \u65b9\u6cd5\uff0c\u53ef\u4ee5\u6839\u636e\u94a9\u5b50\u7684\u540c\u6b65/\u5f02\u6b65\u65b9\u5f0f\u6765\u9009\u62e9\u4e00\u4e2a\u51fd\u6570\u6ce8\u5165\u903b\u8f91\u3002"),c.a.createElement("p",null,"\ud83c\udf30 ",c.a.createElement("strong",null,c.a.createElement("code",null,"tap")," \u540c\u6b65\u94a9\u5b50")),c.a.createElement(r.a,{code:"compiler.hooks.compile.tap('MyPlugin', params => {\n  console.log('\u4ee5\u540c\u6b65\u65b9\u5f0f\u89e6\u53ca compile \u94a9\u5b50\u3002');\n});\n",lang:"js"}),c.a.createElement("p",null,"\ud83c\udf30 ",c.a.createElement("strong",null,c.a.createElement("code",null,"tapAsync")," \u5f02\u6b65\u94a9\u5b50")),c.a.createElement("p",null,"\u901a\u8fc7 ",c.a.createElement("code",null,"callback")," \u56de\u8c03\u544a\u8bc9 Webpack \u5f02\u6b65\u6267\u884c\u5b8c\u6bd5 ",c.a.createElement("code",null,"tapPromise")," \u5f02\u6b65\u94a9\u5b50\uff0c\u8fd4\u56de\u4e00\u4e2a Promise \u544a\u8bc9 Webpack \u5f02\u6b65\u6267\u884c\u5b8c\u6bd5\u3002"),c.a.createElement(r.a,{code:"compiler.hooks.run.tapAsync('MyPlugin', (compiler, callback) => {\n  console.log('\u4ee5\u5f02\u6b65\u65b9\u5f0f\u89e6\u53ca run \u94a9\u5b50\u3002');\n  callback();\n});\n\ncompiler.hooks.run.tapPromise('MyPlugin', compiler => {\n  return new Promise(resolve => setTimeout(resolve, 1000)).then(() => {\n    console.log('\u4ee5\u5177\u6709\u5ef6\u8fdf\u7684\u5f02\u6b65\u65b9\u5f0f\u89e6\u53ca run \u94a9\u5b50');\n  });\n});\n",lang:"js"}),c.a.createElement("h3",{id:"tapable-\u7528\u6cd5"},c.a.createElement("a",{"aria-hidden":"true",href:"#tapable-\u7528\u6cd5"},c.a.createElement("span",{className:"icon icon-link"})),"Tapable \u7528\u6cd5"),c.a.createElement(r.a,{code:"const {\n  SyncHook,\n  SyncBailHook,\n  SyncWaterfallHook,\n  SynLoopHook,\n  AsyncParallelHook,\n  AsyncParallelBailHook,\n  AsyncSeriesHook,\n  ASyncSeriesBailHook,\n  AsyncSeriesWaterfallHook,\n} = require('tapable');\n",lang:"js"}),c.a.createElement("ul",null,c.a.createElement("li",null,c.a.createElement("code",null,"Sync*")," \u540c\u6b65",c.a.createElement("ul",null,c.a.createElement("li",null,c.a.createElement("code",null,"SyncHook")," \u540c\u6b65\u94a9\u5b50"),c.a.createElement("li",null,c.a.createElement("code",null,"SyncBailHook")," \u540c\u6b65\u4fdd\u9669\u94a9\u5b50"),c.a.createElement("li",null,c.a.createElement("code",null,"SyncLoopHook")," \u540c\u6b65\u5faa\u73af\u94a9\u5b50"),c.a.createElement("li",null,c.a.createElement("code",null,"SyncWaterfallHook")," \u540c\u6b65\u7011\u5e03\u94a9\u5b50"))),c.a.createElement("li",null,c.a.createElement("code",null,"Async*")," \u5f02\u6b65",c.a.createElement("ul",null,c.a.createElement("li",null,c.a.createElement("code",null,"AsyncParallel*")," \u5f02\u6b65\u5e76\u884c",c.a.createElement("ul",null,c.a.createElement("li",null,c.a.createElement("code",null,"AsyncParallelHook")," \u5f02\u6b65"),c.a.createElement("li",null,c.a.createElement("code",null,"AsyncParallelBailHook")," \u5f02\u6b65\u5e76\u884c\u4fdd\u9669\u94a9\u5b50"))),c.a.createElement("li",null,c.a.createElement("code",null,"AsyncSeries*")," \u5f02\u6b65\u4e32\u884c",c.a.createElement("ul",null,c.a.createElement("li",null,c.a.createElement("code",null,"AsyncSeriesHook")," \u5f02\u6b65\u4e32\u884c\u94a9\u5b50"),c.a.createElement("li",null,c.a.createElement("code",null,"AsyncSeriesBailHook")," \u5f02\u6b65\u4e32\u884c\u4fdd\u9669\u94a9\u5b50"),c.a.createElement("li",null,c.a.createElement("code",null,"AsyncSeriesWaterfallHook")," \u5f02\u6b65\u4e32\u884c\u7011\u5e03\u94a9\u5b50")))))),c.a.createElement("h3",{id:"\u5b9e\u73b0\u7b80\u6613\u540c\u6b65\u94a9\u5b50"},c.a.createElement("a",{"aria-hidden":"true",href:"#\u5b9e\u73b0\u7b80\u6613\u540c\u6b65\u94a9\u5b50"},c.a.createElement("span",{className:"icon icon-link"})),"\u5b9e\u73b0\u7b80\u6613\u540c\u6b65\u94a9\u5b50"),c.a.createElement(r.a,{code:"class Hook {\n  constructor(args) {\n    this.taps = [];\n    this.interceptors = []; // \u8fd9\u4e2a\u653e\u5728\u540e\u9762\u7528\n    this._args = args;\n  }\n  tap(name, fn) {\n    this.taps.push({ name, fn });\n  }\n}\n\nclass SyncHook extends Hook {\n  call(name, fn) {\n    try {\n      this.taps.forEach(tap => tap.fn(name));\n      fn(null, name);\n    } catch (error) {\n      fn(error);\n    }\n  }\n}\n",lang:"js"}),c.a.createElement("h3",{id:"tapable-\u5982\u4f55\u4e0e\u63d2\u4ef6\u5173\u8054"},c.a.createElement("a",{"aria-hidden":"true",href:"#tapable-\u5982\u4f55\u4e0e\u63d2\u4ef6\u5173\u8054"},c.a.createElement("span",{className:"icon icon-link"})),"Tapable \u5982\u4f55\u4e0e\u63d2\u4ef6\u5173\u8054"),c.a.createElement("p",null,c.a.createElement("strong",null,"Compile.js")),c.a.createElement(r.a,{code:"const { AsyncSeriesHook, SyncHook } = require('tapable');\n\n// \u521b\u5efa\u7c7b\nclass Compiler {\n  constructor() {\n    this.hooks = {\n      // \u5f02\u6b65\u94a9\u5b50\n      run: new AsyncSeriesHook(['compiler']),\n      // \u540c\u6b65\u94a9\u5b50\n      compile: new SyncHook(['params']),\n    };\n  }\n\n  run() {\n    // \u6267\u884c\u5f02\u6b65\u94a9\u5b50\n    this.hooks.run.callAsync(this, err => {\n      this.compile(onCompiled);\n    });\n  }\n\n  compile() {\n    // \u6267\u884c\u540c\u6b65\u94a9\u5b50 \u5e76\u4f20\u53c2\n    this.hooks.compile.call(params);\n  }\n}\n\nmodule.exports = Compile;\n",lang:"js"}),c.a.createElement("p",null,c.a.createElement("strong",null,"MyPlugin.js")),c.a.createElement(r.a,{code:"const Compiler = require('./compiler');\n\nclass MyPlugin {\n  // \u63a5\u53d7 compiler \u53c2\u6570\n  apply(compiler) {\n    compiler.hooks.run.tap('MyPlugin', () => console.log('\u5f00\u59cb\u7f16\u8bd1...'));\n    compiler.hooks.compiler.tapAsync('MyPlugin', (name, age) => {\n      setTimeout(() => {\n        console.log('\u7f16\u8bd1\u4e2d');\n      }, 1000);\n    });\n  }\n}\n\n// \u8fd9\u91cc\u7c7b\u4f3c\u4e8e webpack.config.js \u7684 Plugins \u914d\u7f6e\n// \u5411 Plugins \u5c5e\u6027\u4f20\u5165 new \u5b9e\u4f8b\n\nconst myPlugin = new MyPlugin();\n\nconst options = {\n  plugins: [myPlugin],\n};\n\nlet compiler = new Compiler(options);\ncompiler.run();\n",lang:"js"}),c.a.createElement("h2",{id:"\u7406\u89e3-compiler-\u8d1f\u8d23\u7f16\u8bd1"},c.a.createElement("a",{"aria-hidden":"true",href:"#\u7406\u89e3-compiler-\u8d1f\u8d23\u7f16\u8bd1"},c.a.createElement("span",{className:"icon icon-link"})),"\u7406\u89e3 Compiler \u8d1f\u8d23\u7f16\u8bd1"),c.a.createElement("p",null,"\u5f00\u53d1\u63d2\u4ef6\u9996\u5148\u8981\u77e5\u9053 ",c.a.createElement("code",null,"compiler")," \u548c ",c.a.createElement("code",null,"compilation")," \u5bf9\u8c61\u662f\u505a\u4ec0\u4e48\u7684\u3002"),c.a.createElement("p",null,c.a.createElement("code",null,"Compiler")," \u5bf9\u8c61\u5305\u542b\u4e86\u5f53\u524d\u8fd0\u884c Webpack \u7684\u914d\u7f6e\uff0c\u5305\u62ec ",c.a.createElement("code",null,"entry"),"\u3001",c.a.createElement("code",null,"output"),"\u3001",c.a.createElement("code",null,"loader")," \u7b49\u914d\u7f6e\uff0c\u8fd9\u4e2a\u5bf9\u8c61\u5728\u542f\u52a8 Webpack \u65f6\u88ab\u5b9e\u4f8b\u5316\uff0c\u800c\u4e14\u662f\u5168\u5c40\u552f\u4e00\u7684\u3002",c.a.createElement("code",null,"Plugin")," \u53ef\u4ee5\u901a\u8fc7\u8be5\u5bf9\u8c61\u83b7\u53d6\u5230 Webpack \u7684\u914d\u7f6e\u4fe1\u606f\u8fdb\u884c\u5904\u7406\u3002"),c.a.createElement("p",null,"\u5982\u679c\u770b\u5b8c\u8fd9\u6bb5\u8bdd\uff0c\u4f60\u8fd8\u662f\u6ca1\u7406\u89e3 ",c.a.createElement("code",null,"compiler")," \u662f\u505a\u5565\u7684\uff0c\u4e0d\u8981\u6015\u3002\u8fd0\u884c ",c.a.createElement("code",null,"npm run build"),"\uff0c\u628a ",c.a.createElement("code",null,"compiler")," \u7684\u5168\u90e8\u4fe1\u606f\u8f93\u51fa\u5230\u63a7\u5236\u53f0\u4e0a ",c.a.createElement("code",null,"console.log(compiler)"),"\u3002")),c.a.createElement(m.a,Object(a["a"])({source:{jsx:"import React from 'react';\nimport img from '../../assets/principle-analysis/console-compiler.png';\n\nexport default () => <img alt=\"Compiler\u5bf9\u8c61\u5b9e\u4f8b\" src={img} width={720} />;"}},{inline:!0,dependencies:{},files:{}}),c.a.createElement(p,null)),c.a.createElement("div",{className:"markdown"},c.a.createElement(r.a,{code:"Compiler {\n  _pluginCompat: SyncBailHook {},\n  hooks: {\n    shouldEmit: SyncBailHook {\n      // ...\n    },\n    done: AsyncSeriesHook {\n      // ...\n    },\n    additionalPass: AsyncSerirsHook {\n      // ...\n    },\n    beforeRun: AsyncSeriesHook {\n      // ...\n    },\n    run: AsyncSeriesHook {\n      // ...\n    },\n    emit: AsyncSeriesHook {\n      // ...\n    },\n    assetEmitted: AsyncSeriesHook {\n      // ...\n    },\n    afterEmit: AsyncSeriesHook {\n      // ...\n    },\n    thisCompilation: SyncHook {\n      // ...\n    },\n    compilation: SyncHook {\n      // ...\n    },\n    normalModuleFactory: SyncHook {\n      // ...\n    },\n    contextModuleFacotry: SyncHook {\n      // ...\n    },\n    beforeCompile: AsyncSeriesHook {\n      // ...\n    },\n    compile: SyncHook {\n      // ...\n    },\n    make: AsyncParallelHook {\n      // ...\n    },\n    afterCompile: AsyncSeriesHook {\n      // ...\n    },\n    watchRun: AsyncSeriesHook {\n      // ...\n    },\n    failed: SyncHook {\n      // ...\n    },\n    invalid: SyncHook {\n      // ...\n    },\n    watchClose: SyncHook {\n      // ...\n    },\n    infrastructureLog: SyncBailHook {\n      // ...\n    },\n    environment: SyncHook {\n      // ...\n    },\n    afterEnvironment: SyncHook {\n      // ...\n    },\n    afterPlugins: SyncHook {\n      // ...\n    },\n    afterResolvers: SyncHook {\n      // ...\n    },\n    entryOption: SyncBailHook {\n      // ...\n    },\n    infrastructurelog: SyncBailHook {\n      // ...\n    }\n  },\n  outputPath: '', // \u8f93\u51fa\u76ee\u5f55\n  outputFileSystem: NodeOutputFileSystem {\n    // ...\n  },\n  inputFileSystem: CachedInputFileSystem {\n    // ...\n  },\n  options: {\n    // Compiler \u5bf9\u8c61\u5305\u542b\u4e86 Webpack \u7684\u6240\u6709\u914d\u7f6e\u4fe1\u606f\uff0centry\u3001module\u3001output\u3001resolve \u7b49\u4fe1\u606f\n    entry: [\n      'babel-polyfill',\n      '/Users/mrsingsing/Webpack-Guidebook/example/demo/src/index.js'\n    ],\n    devServer: {\n      port: 3000\n    },\n    output: {\n      // ...\n    },\n    module: {\n      // ...\n    },\n    plugins: [ MyWebpackPlugin {} ],\n    mode: 'production',\n    context: '/Users/mrsingsing/Webpack-Guidebook/example/demo/src/webpack-plugin',\n    devtool: false,\n    performance: {\n      maxAssetSize: 250000,\n      maxEntrypointSize: 250000,\n      hints: 'warning',\n    },\n    optimization: {\n      // ...\n    },\n    resolve: {\n      // ...\n    },\n    resolveLoader: {\n      // ...\n    },\n    infrastructureLogging: {\n      level: 'info',\n      debug: false,\n    }\n  },\n  context: '/Users/mrsingsing/Webpack-Guidebook/example/demo/src/webpack-plugin', // \u4e0a\u4e0b\u6587\uff0c\u6587\u4ef6\u76ee\u5f55\n  requestShortener: RequestShortener {\n    // ...\n  },\n  watchFileSystem: NodeWatchFileSystem {\n    // \u76d1\u542c\u6587\u4ef6\u53d8\u5316\u5217\u8868\u4fe1\u606f\n  }\n}\n",lang:"js"}),c.a.createElement("p",null,"Compiler \u6e90\u7801\u7cbe\u7b80\u7248\u4ee3\u7801\u89e3\u6790"),c.a.createElement("p",null,c.a.createElement("a",{href:"https://github.com/webpack/webpack/blob/master/lib/Compiler.js",target:"_blank",rel:"noopener noreferrer"},"\u6e90\u7801\u5730\u5740",c.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg","aria-hidden":!0,x:"0px",y:"0px",viewBox:"0 0 100 100",width:"15",height:"15",className:"__dumi-default-external-link-icon"},c.a.createElement("path",{fill:"currentColor",d:"M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"}),c.a.createElement("polygon",{fill:"currentColor",points:"45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"})))),c.a.createElement(r.a,{code:"const { SyncHook, SyncBailHook, AsyncSeriesHook } = require('tapable');\n\nclass Compiler {\n  constructor() {\n    // 1. \u5b9a\u4e49\u751f\u547d\u5468\u671f\u94a9\u5b50\n    this.hooks = Object.freeze({\n      // ...\u53ea\u5217\u4e3e\u51e0\u4e2a\u5e38\u7528\u7684\u5e38\u89c1\u94a9\u5b50\uff0c\u66f4\u591a Hook \u5c31\u4e0d\u5217\u4e3e\u4e86\uff0c\u6709\u5174\u8da3\u770b\u6e90\u7801\n      done: new AsyncSeriesHook(['stats']), // \u4e00\u6b21\u7f16\u8bd1\u5b8c\u6210\u540e\u6267\u884c\uff0c\u56de\u8c03\u53c2\u6570\uff1astats\n      beforeRun: new AsyncSeriesHook(['compiler']),\n      run: new AsyncSeriesHook(['compiler']), // \u5728\u7f16\u8bd1\u5668\u5f00\u59cb\u8bfb\u53d6\u8bb0\u5f55\u524d\u6267\u884c\n      emit: new AsyncSeriesHook(['compilation']), // \u5728\u751f\u6210\u6587\u4ef6\u5230 output \u76ee\u5f55\u4e4b\u524d\u6267\u884c\uff0c\u56de\u8c03\u53c2\u6570\uff1acompilation\n      afterEmit: new AsyncSeriesHook(['compilation']), // \u5728\u751f\u6210\u6587\u4ef6\u5230 output \u76ee\u5f55\u4e4b\u540e\u6267\u884c\n      compilation: new SyncHook(['compilation', 'params']), // \u5728\u4e00\u6b21 compilation \u521b\u5efa\u540e\u6267\u884c\u6267\u884c\u63d2\u4ef6\n      beforeCompile: new AsyncSeriesHook(['params']),\n      compile: new SyncHook(['params']), // \u5728\u4e00\u4e2a\u65b0\u7684 compilation \u521b\u5efa\u4e4b\u524d\u6267\u884c\n      make: new AsyncParallelHook(['compilation']), // \u5b8c\u6210\u4e00\u6b21\u7f16\u8bd1\u4e4b\u524d\u6267\u884c\n      afterCompile: new AsyncSeriesHook(['compilation']),\n      watchRun: new AsyncSeriesHook(['compiler']),\n      failed: new SyncHook(['error']),\n      watchClose: new SyncHook([]),\n      afterPlugins: new SyncHook(['compiler']),\n      entryOption: new SyncBailHook(['context', 'entry']),\n    });\n  }\n  newCompilation() {\n    // \u521b\u5efa Compilation \u5bf9\u8c61\u56de\u8c03 compilation \u76f8\u5173\u94a9\u5b50\n    const compilation = new Compilation(this);\n\n    // \u7701\u7565\n\n    this.hooks.compilation.call(compilation, params); // compilation \u5bf9\u8c61\u521b\u5efa\u5b8c\u6210\n    return compilation;\n  }\n  watch() {\n    // \u5982\u679c\u8fd0\u884c\u5728 watch \u6a21\u5f0f\u5219\u6267\u884c watch \u65b9\u6cd5\uff0c\u5426\u5219\u6267\u884c run \u65b9\u6cd5\n    if (this.running) {\n      return handler(new ConcurrentCompilationError());\n    }\n    this.running = true;\n    this.watchMode = true;\n    return new Watching(this, watchOptions, handler);\n  }\n  run(callback) {\n    if (this.running) {\n      return callback(new ConcurrentCompilationError());\n    }\n    this.running = true;\n    process.nextTick(() => {\n      this.emitAssets(compilation, err => {\n        if (err) {\n          // \u5728\u7f16\u8bd1\u548c\u8f93\u51fa\u7684\u6d41\u7a0b\u4e2d\u9047\u5230\u5f02\u5e38\u65f6\uff0c\u4f1a\u89e6\u53d1 failed \u4e8b\u4ef6\n          this.hooks.failed.call(err);\n        }\n        if (compilation.hooks.needAdditionalPass.call()) {\n          // ...\n          // done \u5b8c\u6210\u7f16\u8bd1\n          this.hooks.done.callAsync(stats, err => {\n            // \u521b\u5efa compilation \u5bf9\u8c61\u4e4b\u524d\n            this.compile(onCompiled);\n          });\n        }\n        this.emitRecords(err => {\n          this.hooks.done.callAsync(stats, err => {\n            // ...\n          });\n        });\n      });\n    });\n\n    this.hooks.beforeRun.callAsync(this, err => {\n      this.hooks.run.callAsync(this, err => {\n        this.readRecords(err => {\n          this.compile(onCompiled);\n        });\n      });\n    });\n  }\n  compile(callback) {\n    const params = this.newCompilationParams();\n    this.hooks.beforeCompile.callAsync(params, err => {\n      this.hooks.beforeCompile.call(params);\n      const compilation = this.newCompilation(params);\n      // \u89e6\u53d1 make \u4e8b\u4ef6\u5e76\u8c03\u7528 addEntry\uff0c\u627e\u5230\u5165\u53e3 JS\uff0c\u8fdb\u884c\u4e0b\u4e00\u6b65\n      this.hooks.make.callAsync(compilation, err => {\n        process.nextTick(() => {\n          compilation.finish(err => {\n            // \u5c01\u88c5\u6784\u5efa\u7ed3\u679c\uff08seal\uff09\uff0c\u9010\u6b21\u5bf9\u6bcf\u4e2a module \u548c chunk \u8fdb\u884c\u6574\u7406\uff0c\u6bcf\u4e2a chunk \u5bf9\u5e94\u4e00\u4e2a\u5165\u53e3\u6587\u4ef6\n            compilation.seal(err => {\n              this.hooks.afterCompile.callAsync(compilation, err => {\n                // \u5f02\u6b65\u7684\u4e8b\u4ef6\u9700\u8981\u5728\u63d2\u4ef6\u5904\u7406\u5b8c\u6210\u4efb\u52a1\u65f6\u8c03\u7528\u56de\u8c03\u51fd\u6570\u901a\u77e5 Webpack \u8fdb\u5165\u4e0b\u4e00\u4e2a\u6d41\u7a0b\n                // \u4e0d\u7136\u8fd0\u884c\u6d41\u7a0b\u5c06\u4f1a\u4e00\u76f4\u4f67\u5728\u8fd9\u4e0d\u5f80\u4e0b\u6267\u884c\n                return callback(null, compilation);\n              });\n            });\n          });\n        });\n      });\n    });\n  }\n  emitAssets(compilation, callback) {\n    const emitFiles = err => {\n      // ...\u7701\u7565\n      // afterEmit\uff1a\u6587\u4ef6\u5df2\u7ecf\u5199\u5165\u78c1\u76d8\u5b8c\u6210\n      this.hooks.afterEmit.callAsync(compilation, err => {\n        if (err) return callback(err);\n        return callback();\n      });\n    };\n\n    // emit \u4e8b\u4ef6\u53d1\u751f\u65f6\uff0c\u53ef\u4ee5\u8bfb\u53d6\u5230\u6700\u7ec8\u8f93\u51fa\u7684\u8d44\u6e90\u3001\u4ee3\u7801\u5757\u3001\u6a21\u5757\u53ca\u5176\u4f9d\u8d56\uff0c\u5e76\u8fdb\u884c\u4fee\u6539\uff08\u8fd9\u662f\u6700\u540e\u4e00\u6b21\u4fee\u6539\u6700\u7ec8\u6587\u4ef6\u7684\u673a\u4f1a\uff09\n    this.hooks.emit.callAsync(compilation, err => {\n      if (err) return callback(err);\n      outputPath = compilation.getPath(this.outputPath, {});\n      mkdirp(this.outputFileSystem, outputPath, emitFiles);\n    });\n  }\n}\n",lang:"js"}),c.a.createElement("p",null,c.a.createElement("code",null,"apply")," \u65b9\u6cd5\u4e2d\u63d2\u5165\u94a9\u5b50\u7684\u4e00\u822c\u5f62\u5f0f\u5982\u4e0b\uff1a"),c.a.createElement(r.a,{code:"// compiler \u63d0\u4f9b\u4e86 compiler.hooks\uff0c\u53ef\u4ee5\u6839\u636e\u8fd9\u4e9b\u4e0d\u540c\u7684\u65f6\u523b\u53bb\u8ba9\u63d2\u4ef6\u505a\u4e0d\u540c\u7684\u4e8b\u60c5\ncompiler.hooks.\u9636\u6bb5.tap\u51fd\u6570('\u63d2\u4ef6\u540d\u79f0', \u9636\u6bb5\u56de\u8c03\u53c2\u6570 => {\n  // do something\n});\n\ncompiler.run(callback);\n",lang:"js"}),c.a.createElement("h2",{id:"\u7406\u89e3-compilation-\u8d1f\u8d23\u521b\u5efa-bundle"},c.a.createElement("a",{"aria-hidden":"true",href:"#\u7406\u89e3-compilation-\u8d1f\u8d23\u521b\u5efa-bundle"},c.a.createElement("span",{className:"icon icon-link"})),"\u7406\u89e3 Compilation \u8d1f\u8d23\u521b\u5efa bundle"),c.a.createElement("p",null,"Compilation \u5bf9\u8c61\u4ee3\u8868\u4e86\u4e00\u6b21\u8d44\u6e90\u7248\u672c\u6784\u5efa\u3002\u5f53\u8fd0\u884c Webpack \u5f00\u53d1\u73af\u5883\u4e2d\u95f4\u4ef6\u65f6\uff0c\u6bcf\u5f53\u68c0\u6d4b\u5230\u4e00\u4e2a\u6587\u4ef6\u53d8\u5316\uff0c\u5c31\u4f1a\u521b\u5efa\u65b0\u7684 ",c.a.createElement("code",null,"compilation"),"\uff0c\u4ece\u800c\u751f\u6210\u4e00\u7ec4\u65b0\u7684\u7f16\u8bd1\u8d44\u6e90\u3002\u4e00\u4e2a ",c.a.createElement("code",null,"Compilation")," \u5bf9\u8c61\u8868\u73b0\u4e86\u5f53\u524d\u7684\u6a21\u5757\u8d44\u6e90\u3001\u7f16\u8bd1\u751f\u6210\u8d44\u6e90\u3001\u53d8\u5316\u7684\u6587\u4ef6\u3001\u4ee5\u53ca\u88ab\u8ddf\u8e2a\u4f9d\u8d56\u7684\u72b6\u6001\u4fe1\u606f\uff0c\u7b80\u5355\u6765\u8bb2\u5c31\u662f\u628a\u672c\u6b21\u6253\u5305\u7f16\u8bd1\u7684\u5185\u5bb9\u5b58\u5230\u5185\u5b58\u91cc\u3002Compilation \u5bf9\u8c61\u4e5f\u63d0\u4f9b\u4e86\u63d2\u4ef6\u9700\u8981\u81ea\u5b9a\u4e49\u529f\u80fd\u7684\u56de\u8c03\uff0c\u4ee5\u4f9b\u63d2\u4ef6\u505a\u81ea\u5b9a\u4e49\u5904\u7406\u65f6\u9009\u62e9\u4f7f\u7528\u62d3\u5c55\u3002"),c.a.createElement("p",null,"\u7b80\u5355\u6765\u8bf4\uff0cCompilation \u7684\u804c\u8d23\u5c31\u662f\u6784\u5efa\u6a21\u5757\u548c Chunk\uff0c\u5e76\u5229\u7528\u63d2\u4ef6\u4f18\u5316\u6784\u5efa\u8fc7\u7a0b\u3002"),c.a.createElement("p",null,"\u548c Compiler \u7528\u6cd5\u76f8\u540c\uff0c\u94a9\u5b50\u7c7b\u578b\u4e0d\u540c\uff0c\u4e5f\u53ef\u4ee5\u5728\u67d0\u4e9b\u94a9\u5b50\u4e0a\u8bbf\u95ee ",c.a.createElement("code",null,"tapAsync")," \u548c ",c.a.createElement("code",null,"tapPromise"),"\u3002"),c.a.createElement("p",null,"\u63a7\u5236\u53f0\u8f93\u51fa ",c.a.createElement("code",null,"console.log(compilation)"),"\uff1a")),c.a.createElement(m.a,Object(a["a"])({source:{jsx:"import React from 'react';\nimport img from '../../assets/principle-analysis/console-compilation.png';\n\nexport default () => <img alt=\"Compilation\" src={img} width={720} />;"}},{inline:!0,dependencies:{},files:{}}),c.a.createElement(u,null)),c.a.createElement("div",{className:"markdown"},c.a.createElement("p",null,"\u901a\u8fc7 Compilation \u4e5f\u80fd\u8bfb\u53d6\u5230 Compiler \u5bf9\u8c61\u3002"),c.a.createElement("p",null,"\u5e38\u7528 Compilation Hooks\uff1a"),c.a.createElement("table",null,c.a.createElement("thead",null,c.a.createElement("tr",null,c.a.createElement("th",null,"\u94a9\u5b50"),c.a.createElement("th",null,"\u7c7b\u578b"),c.a.createElement("th",null,"\u8c03\u7528\u65f6\u673a"))),c.a.createElement("tbody",null,c.a.createElement("tr",null,c.a.createElement("td",null,"buildModule"),c.a.createElement("td",null,"SyncHook"),c.a.createElement("td",null,"\u5728\u6a21\u5757\u5f00\u59cb\u7f16\u8bd1\u4e4b\u524d\u89e6\u53d1\uff0c\u53ef\u4ee5\u7528\u4e8e\u4fee\u6539\u6a21\u5757")),c.a.createElement("tr",null,c.a.createElement("td",null,"succeedModule"),c.a.createElement("td",null,"SyncHook"),c.a.createElement("td",null,"\u5f53\u4e00\u4e2a\u6a21\u5757\u88ab\u6210\u529f\u7f16\u8bd1\uff0c\u4f1a\u6267\u884c\u8fd9\u4e2a\u94a9\u5b50")),c.a.createElement("tr",null,c.a.createElement("td",null,"finishModules"),c.a.createElement("td",null,"AsyncSeriesHook"),c.a.createElement("td",null,"\u5f53\u6240\u6709\u6a21\u5757\u90fd\u7f16\u8bd1\u6210\u529f\u540e\u88ab\u8c03\u7528")),c.a.createElement("tr",null,c.a.createElement("td",null,"seal"),c.a.createElement("td",null,"SyncHook"),c.a.createElement("td",null,"\u5f53\u4e00\u6b21 ",c.a.createElement("code",null,"compilation")," \u505c\u6b62\u63a5\u6536\u65b0\u6a21\u5757\u65f6\u89e6\u53d1")),c.a.createElement("tr",null,c.a.createElement("td",null,"optimizeDependencies"),c.a.createElement("td",null,"SyncBailHook"),c.a.createElement("td",null,"\u5728\u4f9d\u8d56\u4f18\u5316\u7684\u5f00\u59cb\u6267\u884c")),c.a.createElement("tr",null,c.a.createElement("td",null,"optimize"),c.a.createElement("td",null,"SyncHook"),c.a.createElement("td",null,"\u5728\u4f18\u5316\u9636\u6bb5\u7684\u5f00\u59cb\u6267\u884c")),c.a.createElement("tr",null,c.a.createElement("td",null,"optimizeModules"),c.a.createElement("td",null,"SyncBailHook"),c.a.createElement("td",null,"\u5728\u6a21\u5757\u4f18\u5316\u9636\u6bb5\u5f00\u59cb\u65f6\u6267\u884c\uff0c\u63d2\u4ef6\u53ef\u4ee5\u5728\u8fd9\u4e2a\u94a9\u5b50\u91cc\u6267\u884c\u5bf9\u6a21\u5757\u7684\u4f18\u5316\uff0c\u56de\u8c03\u53c2\u6570\uff1a",c.a.createElement("code",null,"modules"))),c.a.createElement("tr",null,c.a.createElement("td",null,"optimizeChunks"),c.a.createElement("td",null,"SyncBailHook"),c.a.createElement("td",null,"\u5728\u4ee3\u7801\u5757\u4f18\u5316\u9636\u6bb5\u5f00\u59cb\u65f6\u6267\u884c\uff0c\u63d2\u4ef6\u53ef\u4ee5\u5728\u8fd9\u4e2a\u94a9\u5b50\u91cc\u6267\u884c\u5bf9\u4ee3\u7801\u5757\u7684\u4f18\u5316\uff0c\u56de\u8c03\u53c2\u6570\uff1a",c.a.createElement("code",null,"chunks"))),c.a.createElement("tr",null,c.a.createElement("td",null,"optimizeChunkAssets"),c.a.createElement("td",null,"AsyncSeriesHook"),c.a.createElement("td",null,"\u4f18\u5316\u4efb\u4f55\u4ee3\u7801\u5757\u8d44\u6e90\uff0c\u8fd9\u4e9b\u8d44\u6e90\u5b58\u653e\u5728 ",c.a.createElement("code",null,"compilation.assets")," \u4e0a\u3002\u4e00\u4e2a Chunk \u6709\u4e00\u4e2a files \u5c5e\u6027")),c.a.createElement("tr",null,c.a.createElement("td",null,"optimizeAssets"),c.a.createElement("td",null,"AsyncSeriesHook"),c.a.createElement("td",null,"\u4f18\u5316\u6240\u6709\u5b58\u653e\u5728 ",c.a.createElement("code",null,"compilation.assets")," \u7684\u6240\u6709\u8d44\u6e90\u3002\u56de\u8c03\u53c2\u6570\uff1a",c.a.createElement("code",null,"assets"))))),c.a.createElement("h2",{id:"compiler-\u548c-compilation-\u7684\u533a\u522b"},c.a.createElement("a",{"aria-hidden":"true",href:"#compiler-\u548c-compilation-\u7684\u533a\u522b"},c.a.createElement("span",{className:"icon icon-link"})),"Compiler \u548c Compilation \u7684\u533a\u522b"),c.a.createElement("p",null,"Compiler \u4ee3\u8868\u4e86\u6574\u4e2a Webpack \u4ece\u542f\u52a8\u5230\u5173\u95ed\u7684\u751f\u547d\u5468\u671f\uff0c\u800c Compilation \u53ea\u662f\u4ee3\u8868\u4e86\u4e00\u6b21\u65b0\u7684\u7f16\u8bd1\uff0c\u53ea\u8981\u6587\u4ef6\u6709\u6539\u52a8\uff0c",c.a.createElement("code",null,"compilation")," \u5c31\u4f1a\u88ab\u91cd\u65b0\u521b\u5efa\u3002"),c.a.createElement("h2",{id:"\u5e38\u7528-api"},c.a.createElement("a",{"aria-hidden":"true",href:"#\u5e38\u7528-api"},c.a.createElement("span",{className:"icon icon-link"})),"\u5e38\u7528 API"),c.a.createElement("p",null,"\u63d2\u4ef6\u53ef\u4ee5\u7528\u6765\u4fee\u6539\u8f93\u51fa\u6587\u4ef6\u3001\u589e\u52a0\u8f93\u51fa\u6587\u4ef6\u3001\u751a\u81f3\u53ef\u4ee5\u63d0\u5347 Webpack \u6027\u80fd\u7b49\u7b49\uff0c\u603b\u4e4b\u63d2\u4ef6\u901a\u8fc7\u8c03\u7528 Webpack \u63d0\u4f9b\u7684 API \u80fd\u5b8c\u6210\u5f88\u591a\u4e8b\u60c5\u3002\u7531\u4e8e Webpack \u63d0\u4f9b\u7684 API \u975e\u5e38\u591a\uff0c\u6709\u5f88\u591a API \u5f88\u5c11\u7528\u5f97\u4e0a\uff0c\u53c8\u52a0\u4e0a\u7bc7\u5e45\u6709\u9650\uff0c\u4e0b\u9762\u4ecb\u7ecd\u5e38\u7528\u7684 API\u3002"),c.a.createElement("h3",{id:"\u8bfb\u53d6\u8f93\u51fa\u8d44\u6e90\u3001\u4ee3\u7801\u5757\u3001\u6a21\u5757\u53ca\u5176\u4f9d\u8d56"},c.a.createElement("a",{"aria-hidden":"true",href:"#\u8bfb\u53d6\u8f93\u51fa\u8d44\u6e90\u3001\u4ee3\u7801\u5757\u3001\u6a21\u5757\u53ca\u5176\u4f9d\u8d56"},c.a.createElement("span",{className:"icon icon-link"})),"\u8bfb\u53d6\u8f93\u51fa\u8d44\u6e90\u3001\u4ee3\u7801\u5757\u3001\u6a21\u5757\u53ca\u5176\u4f9d\u8d56"),c.a.createElement("p",null,"\u6709\u4e9b\u63d2\u4ef6\u53ef\u80fd\u9700\u8981\u8bfb\u53d6 Webpack \u7684\u5904\u7406\u7ed3\u679c\uff0c\u4f8b\u5982\u8f93\u51fa\u8d44\u6e90\u3001\u4ee3\u7801\u5757\u3001\u6a21\u5757\u53ca\u5176\u4f9d\u8d56\uff0c\u4ee5\u4fbf\u505a\u4e0b\u4e00\u6b65\u5904\u7406\u3002\u5728 emit \u4e8b\u4ef6\u53d1\u751f\u65f6\uff0c\u4ee3\u8868\u6e90\u6587\u4ef6\u7684\u8f6c\u6362\u548c\u7ec4\u88c5\u5df2\u7ecf\u5b8c\u6210\uff0c\u5728\u8fd9\u91cc\u53ef\u4ee5\u8bfb\u53d6\u5230\u6700\u7ec8\u5c06\u8f93\u51fa\u7684\u8d44\u6e90\u3001\u4ee3\u7801\u5757\u3001\u6a21\u5757\u53ca\u5176\u4f9d\u8d56\uff0c\u5e76\u4e14\u53ef\u4ee5\u4fee\u6539\u8f93\u51fa\u8d44\u6e90\u7684\u5185\u5bb9\u3002\u63d2\u4ef6\u4ee3\u7801\u5982\u4e0b\uff1a"),c.a.createElement(r.a,{code:"class Plugin {\n  apply(compiler) {\n    comiler.plugin('emit', function(compilation, callback) {\n      // compilation.chunks \u5b58\u653e\u6240\u6709\u4ee3\u7801\u5757\uff0c\u662f\u4e00\u4e2a\u6570\u7ec4\n      compilation.chunks.forEach(function (chunk) {\n        // chunk \u4ee3\u8868\u4e00\u4e2a\u4ee3\u7801\u5757\n        // \u4ee3\u7801\u5757\u7531\u591a\u4e2a\u6a21\u5757\u7ec4\u6210\uff0c\u901a\u8fc7 chunk.forEachModule \u80fd\u8bfb\u53d6\u7ec4\u6210\u4ee3\u7801\u5757\u7684\u6bcf\u4e2a\u6a21\u5757\n        chunk.forEachModule(function(module) {\n          // module \u4ee3\u8868\u4e00\u4e2a\u6a21\u5757\n          // module.fileDependencies \u5b58\u653e\u5f53\u524d\u6a21\u5757\u7684\u6240\u6709\u4f9d\u8d56\u7684\u6587\u4ef6\u8def\u5f84\uff0c\u662f\u4e00\u4e2a\u6570\u7ec4\n          module.fileDependencies.forEach(function(filepath) {\n            // ...\n          })\n        })\n\n        // Webpack \u4f1a\u6839\u636e Chunk \u53bb\u751f\u6210\u8f93\u51fa\u7684\u6587\u4ef6\u8d44\u6e90\uff0c\u6bcf\u4e2a Chunk \u90fd\u5bf9\u5e94\u4e00\u4e2a\u53ca\u5176\u4ee5\u4e0a\u7684\u8f93\u51fa\u6587\u4ef6\n        // \u4f8b\u5982\u5728 Chunk \u4e2d\u5305\u542b\u4e86 CSS \u6a21\u5757\u5e76\u4e14\u4f7f\u7528\u4e86 ExtractTextPlugin \u65f6\n        // \u8be5 Chunk \u5c31\u4f1a\u751f\u6210 .js \u548c .css \u4e24\u4e2a\u6587\u4ef6\n        chunk.files.forEach(function(filename) {\n          // compilation.assets \u5b58\u653e\u5f53\u524d\u6240\u6709\u5373\u5c06\u8f93\u51fa\u7684\u8d44\u6e90\n          // \u8c03\u7528\u4e00\u4e2a\u8f93\u51fa\u8d44\u6e90\u7684 source() \u65b9\u6cd5\u80fd\u83b7\u53d6\u5230\u8f93\u51fa\u8d44\u6e90\u7684\u5185\u5bb9\n          let source = compilation.assets.[filename].source()\n        });\n      });\n\n      // \u8fd9\u662f\u4e00\u4e2a\u5f02\u6b65\u4e8b\u4ef6\uff0c\u8981\u8bb0\u5f97\u8c03\u7528 callback \u901a\u77e5 Webpack \u672c\u6b21\u4e8b\u4ef6\u76d1\u542c\u5904\u7406\u7ed3\u675f\n      // \u5982\u679c\u5fd8\u8bb0\u4e86\u8c03\u7528 callback\uff0cWebpack \u5c06\u4e00\u76f4\u5361\u5728\u8fd9\u91cc\u800c\u4e0d\u4f1a\u5f80\u540e\u6267\u884c\n      callback();\n    })\n  }\n}\n",lang:"js"}),c.a.createElement("h3",{id:"\u76d1\u542c\u6587\u4ef6\u53d8\u5316"},c.a.createElement("a",{"aria-hidden":"true",href:"#\u76d1\u542c\u6587\u4ef6\u53d8\u5316"},c.a.createElement("span",{className:"icon icon-link"})),"\u76d1\u542c\u6587\u4ef6\u53d8\u5316"),c.a.createElement("p",null,"Webpack \u4f1a\u4ece\u914d\u7f6e\u7684\u5165\u53e3\u6a21\u5757\u89e6\u53d1\uff0c\u4f9d\u6b21\u627e\u51fa\u6240\u6709\u7684\u4f9d\u8d56\u6a21\u5757\uff0c\u5f53\u5165\u53e3\u6a21\u5757\u6216\u8005\u5176\u4f9d\u8d56\u7684\u6a21\u5757\u53d1\u751f\u53d8\u5316\u65f6\uff0c\u5c31\u4f1a\u89e6\u53d1\u4f9d\u6b21\u65b0\u7684 Compilation\u3002"),c.a.createElement("p",null,"\u5728\u5f00\u53d1\u63d2\u4ef6\u65f6\u7ecf\u5e38\u9700\u8981\u77e5\u9053\u662f\u54ea\u4e2a\u6587\u4ef6\u53d1\u751f\u53d8\u5316\u5bfc\u81f4\u4e86\u65b0\u7684 Compilation\uff0c\u4e3a\u6b64\u53ef\u4ee5\u4f7f\u7528\u5982\u4e0b\u4ee3\u7801\uff1a"),c.a.createElement(r.a,{code:"// \u5f53\u4f9d\u8d56\u7684\u6587\u4ef6\u53d1\u751f\u53d8\u5316\u65f6\u4f1a\u89e6\u53d1 watch-run \u4e8b\u4ef6\ncompiler.hooks.watchRun.tap('MyPlugin', (watching, callback) => {\n  // \u83b7\u53d6\u53d1\u751f\u53d8\u5316\u7684\u6587\u4ef6\u5217\u8868\n  const changedFiles = watching.compiler.watchFileSystem.watcher.mtimes;\n  // changedFiles \u683c\u5f0f\u4e3a\u952e\u503c\u5bf9\uff0c\u952e\u4e3a\u53d1\u751f\u53d8\u5316\u7684\u6587\u4ef6\u8def\u5f84\n  if (changedFiles[filePath] !== undefined) {\n    // filePath \u5bf9\u5e94\u7684\u6587\u4ef6\u53d1\u751f\u4e86\u53d8\u5316\n  }\n  callback();\n});\n",lang:"js"}),c.a.createElement("p",null,"\u9ed8\u8ba4\u60c5\u51b5\u4e0b Webpack \u53ea\u4f1a\u76d1\u89c6\u5165\u53e3\u548c\u5176\u4ed6\u4f9d\u8d56\u7684\u6a21\u5757\u662f\u5426\u53d1\u751f\u53d8\u5316\uff0c\u5728\u6709\u4e9b\u60c5\u51b5\u4e0b\u9879\u76ee\u53ef\u80fd\u9700\u8981\u5f15\u5165\u65b0\u7684\u6587\u4ef6\uff0c\u4f8b\u5982\u5f15\u5165\u4e00\u4e2a HTML \u6587\u4ef6\u3002\u7531\u4e8e JavaScript \u6587\u4ef6\u4e0d\u4f1a\u53bb\u5bfc\u5165 HTML \u6587\u4ef6\uff0cWebpack \u5c31\u4e0d\u4f1a\u76d1\u542c HTML \u6587\u4ef6\u7684\u53d8\u5316\uff0c\u7f16\u8f91 HTML \u6587\u4ef6\u65f6\u5c31\u4e0d\u4f1a\u91cd\u65b0\u89e6\u53d1\u65b0\u7684 Compilation\u3002\u4e3a\u4e86\u76d1\u542c HTML \u6587\u4ef6\u7684\u53d8\u5316\uff0c\u6211\u4eec\u9700\u8981\u628a HTML \u6587\u4ef6\u52a0\u5165\u5230\u4f9d\u8d56\u5217\u8868\u4e2d\uff0c\u4e3a\u6b64\u53ef\u4ee5\u4f7f\u7528\u5982\u4e0b\u4ee3\u7801\uff1a"),c.a.createElement(r.a,{code:"compiler.hooks.afterCompile.tap('MyPlugin', (compilation, callback) => {\n  // \u628a HTML \u6587\u4ef6\u6dfb\u52a0\u5230\u6587\u4ef6\u4f9d\u8d56\u5217\u8868\uff0c\u597d\u8ba9 Webpack \u53bb\u76d1\u542c HTML \u6a21\u5757\u6587\u4ef6\uff0c\u5728 HTML \u6a21\u7248\u6587\u4ef6\u53d1\u751f\u53d8\u5316\u65f6\u91cd\u65b0\u542f\u52a8\u4f9d\u6b21\u7f16\u8bd1\n  compilation.fileDependencies.push(filePath);\n  callback();\n});\n",lang:"js"}),c.a.createElement("h3",{id:"\u4fee\u6539\u8f93\u51fa\u8d44\u6e90"},c.a.createElement("a",{"aria-hidden":"true",href:"#\u4fee\u6539\u8f93\u51fa\u8d44\u6e90"},c.a.createElement("span",{className:"icon icon-link"})),"\u4fee\u6539\u8f93\u51fa\u8d44\u6e90"),c.a.createElement("p",null,"\u6709\u4e9b\u573a\u666f\u4e0b\u63d2\u4ef6\u9700\u8981\u4fee\u6539\u3001\u589e\u52a0\u3001\u5220\u9664\u8f93\u51fa\u7684\u8d44\u6e90\uff0c\u8981\u505a\u5230\u8fd9\u70b9\u9700\u8981\u76d1\u542c ",c.a.createElement("code",null,"emit")," \u4e8b\u4ef6\uff0c\u56e0\u4e3a\u53d1\u751f ",c.a.createElement("code",null,"emit")," \u4e8b\u4ef6\u65f6\u6240\u6709\u6a21\u5757\u7684\u8f6c\u6362\u548c\u4ee3\u7801\u5757\u5bf9\u5e94\u7684\u6587\u4ef6\u5df2\u7ecf\u751f\u6210\u597d\uff0c\u9700\u8981\u8f93\u51fa\u7684\u8d44\u6e90\u5373\u5c06\u8f93\u51fa\uff0c\u56e0\u6b64 ",c.a.createElement("code",null,"emit")," \u4e8b\u4ef6\u662f\u4fee\u6539 Webpack \u8f93\u51fa\u8d44\u6e90\u7684\u6700\u540e\u65f6\u673a\u3002"),c.a.createElement("p",null,"\u6240\u6709\u9700\u8981\u8f93\u51fa\u7684\u8d44\u6e90\u4f1a\u5b58\u653e\u5728 ",c.a.createElement("code",null,"compilation.assets")," \u4e2d\uff0c",c.a.createElement("code",null,"compilation.assets")," \u662f\u4e00\u4e2a\u952e\u503c\u5bf9\uff0c\u952e\u4e3a\u9700\u8981\u8f93\u51fa\u7684\u6587\u4ef6\u540d\u79f0\uff0c\u503c\u4e3a\u6587\u4ef6\u5bf9\u5e94\u7684\u5185\u5bb9\u3002"),c.a.createElement("p",null,"\u8bbe\u7f6e ",c.a.createElement("code",null,"compilation.assets")," \u7684\u4ee3\u7801\u5982\u4e0b\uff1a"),c.a.createElement(r.a,{code:"// \u8bbe\u7f6e\u540d\u79f0\u4e3a fileName \u7684\u8f93\u51fa\u8d44\u6e90\ncompilation.assets[fileName] = {\n  // \u8fd4\u56de\u6587\u4ef6\u5185\u5bb9\n  source: () => {\n    // fileContent \u65e2\u53ef\u4ee5\u662f\u4ee3\u8868\u6587\u672c\u6587\u4ef6\u7684\u5b57\u7b26\u4e32\uff0c\u4e5f\u53ef\u4ee5\u662f\u4ee3\u8868\u4e8c\u8fdb\u5236\u6587\u4ef6\u7684 Buffer\n    return fileContent;\n  },\n  // \u8fd4\u56de\u6587\u4ef6\u5927\u5c0f\n  size: () => {\n    return Buffer.byteLength(fileContent, 'utf8');\n  },\n};\n",lang:"js"}),c.a.createElement("h3",{id:"\u5224\u65ad-webpack-\u4f7f\u7528\u4e86\u54ea\u4e9b\u63d2\u4ef6"},c.a.createElement("a",{"aria-hidden":"true",href:"#\u5224\u65ad-webpack-\u4f7f\u7528\u4e86\u54ea\u4e9b\u63d2\u4ef6"},c.a.createElement("span",{className:"icon icon-link"})),"\u5224\u65ad Webpack \u4f7f\u7528\u4e86\u54ea\u4e9b\u63d2\u4ef6"),c.a.createElement(r.a,{code:"// \u5224\u65ad\u5f53\u524d\u914d\u7f6e\u4f7f\u7528\u4e86 ExtractTextPlugin\n// compiler \u53c2\u6570\u5373\u4e3a Webpack \u5728 apply(compiler) \u4e2d\u4f20\u5165\u7684\u53c2\u6570\nfunction hasExtractTextPlugin(compiler) {\n  // \u5f53\u524d\u914d\u7f6e\u6240\u6709\u4f7f\u7528\u7684\u63d2\u4ef6\u5217\u8868\n  const plugins = compiler.options.plugins;\n  // \u53bb plugins \u4e2d\u5bfb\u627e\u6709\u6ca1\u6709 ExtractTextPlugin \u7684\u5b9e\u4f8b\n  return plugins.find(plugin => plugin.__proto__.constructor === ExtractTextPlugin) != null;\n}\n",lang:"js"}),c.a.createElement("h3",{id:"\u6587\u4ef6\u5199\u5165"},c.a.createElement("a",{"aria-hidden":"true",href:"#\u6587\u4ef6\u5199\u5165"},c.a.createElement("span",{className:"icon icon-link"})),"\u6587\u4ef6\u5199\u5165"),c.a.createElement("p",null,"Compilation \u4e0a\u7684 assets \u53ef\u4ee5\u7528\u4e8e\u6587\u4ef6\u5199\u5165"),c.a.createElement("ul",null,c.a.createElement("li",null,"\u53ef\u5c06 zip \u8d44\u6e90\u5305\u8bbe\u7f6e\u4e3a ",c.a.createElement("code",null,"compilation.assets")," \u5bf9\u8c61\u4e0a")),c.a.createElement("p",null,"\u6587\u4ef6\u5199\u5165\u9700\u8981\u4f7f\u7528 ",c.a.createElement("a",{href:"https://www.npmjs.com/package/webpack-sources",target:"_blank",rel:"noopener noreferrer"},"webpack-sources",c.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg","aria-hidden":!0,x:"0px",y:"0px",viewBox:"0 0 100 100",width:"15",height:"15",className:"__dumi-default-external-link-icon"},c.a.createElement("path",{fill:"currentColor",d:"M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"}),c.a.createElement("polygon",{fill:"currentColor",points:"45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"})))),c.a.createElement(r.a,{code:"const { RawSource } = require('webpack-sources');\n\nmodule.exports = class DemoPlugin {\n  constructor(options) {\n    this.options = options;\n  }\n\n  apply(compiler) {\n    const { name } = this.options;\n    compilation.plugin('emit', (compilation, cb) => {\n      compilation.assets[name] = new RawSource('demo');\n      cb();\n    });\n  }\n};\n",lang:"js"}),c.a.createElement("h3",{id:"\u5f02\u5e38\u6216\u8b66\u544a\u5904\u7406"},c.a.createElement("a",{"aria-hidden":"true",href:"#\u5f02\u5e38\u6216\u8b66\u544a\u5904\u7406"},c.a.createElement("span",{className:"icon icon-link"})),"\u5f02\u5e38\u6216\u8b66\u544a\u5904\u7406"),c.a.createElement("p",null,"\u505a\u4e00\u4e2a\u5b9e\u9a8c\uff0c\u5982\u679c\u4f60\u5728 ",c.a.createElement("code",null,"apply")," \u51fd\u6570\u5185\u63d2\u5165 ",c.a.createElement("code",null,'throw new Error("message")'),"\uff0c\u7ec8\u7aef\u4f1a\u6253\u5370\u51fa ",c.a.createElement("code",null,"Unhandled rejection Error: Message"),"\u3002\u7136\u540e Webpack \u4e2d\u65ad\u6267\u884c\u3002\u4e3a\u4e86\u4e0d\u5f71\u54cd Webpack \u7684\u6267\u884c\uff0c\u8981\u5728\u7f16\u8bd1\u671f\u95f4\u5411\u7528\u6237\u53d1\u51fa\u8b66\u544a\u6216\u9519\u8bef\u6d88\u606f\uff0c\u5219\u5e94\u4f7f\u7528 ",c.a.createElement("code",null,"compilation.warnings")," \u548c ",c.a.createElement("code",null,"compilation.errors"),"\u3002"),c.a.createElement(r.a,{code:"compilation.warnings.push('warning');\n\ncompilation.errors.push('error');\n",lang:"js"}),c.a.createElement("h3",{id:"\u63d2\u4ef6\u6269\u5c55\uff1a\u7f16\u5199\u63d2\u4ef6\u7684\u63d2\u4ef6"},c.a.createElement("a",{"aria-hidden":"true",href:"#\u63d2\u4ef6\u6269\u5c55\uff1a\u7f16\u5199\u63d2\u4ef6\u7684\u63d2\u4ef6"},c.a.createElement("span",{className:"icon icon-link"})),"\u63d2\u4ef6\u6269\u5c55\uff1a\u7f16\u5199\u63d2\u4ef6\u7684\u63d2\u4ef6"),c.a.createElement("p",null,"\u63d2\u4ef6\u81ea\u8eab\u4e5f\u53ef\u4ee5\u901a\u8fc7\u66b4\u9732 hooks \u7684\u65b9\u5f0f\u8fdb\u884c\u81ea\u8eab\u6269\u5c55\uff0c\u4ee5 ",c.a.createElement("code",null,"html-webpack-plugin")," \u4e3a\u4f8b\uff1a"),c.a.createElement("ul",null,c.a.createElement("li",null,c.a.createElement("code",null,"html-webpack-plugin-alter-chunks"),"\uff08Sync\uff09"),c.a.createElement("li",null,c.a.createElement("code",null,"html-webpack-plugin-before-html-generation"),"\uff08Async\uff09"),c.a.createElement("li",null,c.a.createElement("code",null,"html-webpack-plugin-alter-asset-tags"),"\uff08Async\uff09"),c.a.createElement("li",null,c.a.createElement("code",null,"html-webpack-plugin-after-html-processing"),"\uff08Async\uff09"),c.a.createElement("li",null,c.a.createElement("code",null,"html-webpack-plugin-after-emit"),"\uff08Async\uff09")),c.a.createElement("h2",{id:"\u5f00\u53d1\u8c03\u8bd5"},c.a.createElement("a",{"aria-hidden":"true",href:"#\u5f00\u53d1\u8c03\u8bd5"},c.a.createElement("span",{className:"icon icon-link"})),"\u5f00\u53d1\u8c03\u8bd5"),c.a.createElement("ol",null,c.a.createElement("li",null,"\u5728\u5f53\u524d Webpack \u9879\u76ee\u5de5\u7a0b\u6587\u4ef6\u5939\u4e0b\u9762\uff0c\u6267\u884c\u547d\u4ee4\u884c\uff1a")),c.a.createElement(r.a,{code:"node --inspect-brk ./node_modules/webpack/bin/webpack.js --inline --progress\n",lang:"bash"}),c.a.createElement("p",null,"\u5176\u4e2d\u53c2\u6570 ",c.a.createElement("code",null,"--inspect-brk")," \u5c31\u662f\u4ee5\u8c03\u8bd5\u6a21\u5f0f\u542f\u52a8 Node\uff1a"),c.a.createElement("p",null,"\u7ec8\u7aef\u4f1a\u8f93\u51fa\uff1a"),c.a.createElement(r.a,{code:"Debugger listening on ws://127.0.0.1:9229/1018c03f-7473-4d60-b62c-949a6404c81d\nFor help, see: https://nodejs.org/en/docs/inspector\n",lang:"bash"}),c.a.createElement("ol",{start:"2"},c.a.createElement("li",null,"Chrome \u8f93\u5165 ",c.a.createElement("code",null,"chrome://inspect/#devices")))),c.a.createElement(m.a,Object(a["a"])({source:{jsx:"import React from 'react';\nimport img from '../../assets/principle-analysis/chrome-devices-inspect.jpeg';\n\nexport default () => <img alt=\"\u6d4f\u89c8\u5668\u8c03\u8bd5\u6a21\u5f0f\" src={img} width={640} />;"}},{inline:!0,dependencies:{},files:{}}),c.a.createElement(d,null)),c.a.createElement("div",{className:"markdown"},c.a.createElement("ol",{start:"3"},c.a.createElement("li",null,"\u7136\u540e\u70b9\u51fb Chrome \u8c03\u8bd5\u5668\u4e2d\u7684 ",c.a.createElement("code",null,"\u7ee7\u7eed\u6267\u884c"),"\uff0c\u65ad\u7535\u5c31\u63d0\u7559\u5728\u6211\u4eec\u8bbe\u7f6e\u5728\u63d2\u4ef6\u4e2d\u7684 bugger \u65ad\u70b9\u4e86"))),c.a.createElement(m.a,Object(a["a"])({source:{jsx:"import React from 'react';\nimport img from '../../assets/principle-analysis/chrome-debugger.jpeg';\n\nexport default () => <img alt=\"\u4ee3\u7801\u65ad\u70b9\" src={img} width={640} />;"}},{inline:!0,dependencies:{},files:{}}),c.a.createElement(E,null)),c.a.createElement("div",{className:"markdown"},c.a.createElement("hr",null),c.a.createElement("p",null,c.a.createElement("strong",null,"\u53c2\u8003\u8d44\u6599\uff1a")),c.a.createElement("ul",null,c.a.createElement("li",null,c.a.createElement("a",{href:"https://juejin.im/post/5ec169786fb9a043721b46ad",target:"_blank",rel:"noopener noreferrer"},"\ud83d\udcdd \u63ed\u79d8 Webpack \u63d2\u4ef6\u5de5\u4f5c\u6d41\u7a0b\u548c\u539f\u7406\uff082020-05-18\uff09",c.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg","aria-hidden":!0,x:"0px",y:"0px",viewBox:"0 0 100 100",width:"15",height:"15",className:"__dumi-default-external-link-icon"},c.a.createElement("path",{fill:"currentColor",d:"M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"}),c.a.createElement("polygon",{fill:"currentColor",points:"45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"})))),c.a.createElement("li",null,c.a.createElement("a",{href:"https://juejin.im/post/5ec16a2e5188256d841a53d0",target:"_blank",rel:"noopener noreferrer"},"\ud83d\udcdd \u5b9e\u73b0\u81ea\u5b9a\u4e49 Webpack \u63d2\u4ef6\u8be6\u89e3\uff082020-05-19\uff09",c.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg","aria-hidden":!0,x:"0px",y:"0px",viewBox:"0 0 100 100",width:"15",height:"15",className:"__dumi-default-external-link-icon"},c.a.createElement("path",{fill:"currentColor",d:"M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"}),c.a.createElement("polygon",{fill:"currentColor",points:"45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"})))),c.a.createElement("li",null,c.a.createElement("a",{href:"http://wushaobin.top/2019/03/15/webpackPlugin/",target:"_blank",rel:"noopener noreferrer"},"\ud83d\udcdd Webpack \u5b66\u4e60 \u2014 Plugin\uff082019-03-15\uff09",c.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg","aria-hidden":!0,x:"0px",y:"0px",viewBox:"0 0 100 100",width:"15",height:"15",className:"__dumi-default-external-link-icon"},c.a.createElement("path",{fill:"currentColor",d:"M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"}),c.a.createElement("polygon",{fill:"currentColor",points:"45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"})))),c.a.createElement("li",null,c.a.createElement("a",{href:"https://zhuanlan.zhihu.com/p/26955349",target:"_blank",rel:"noopener noreferrer"},"\ud83d\udcdd \u6d45\u6790 Webpack \u63d2\u4ef6\u5316\u8bbe\u8ba1\uff082017-05-18\uff09",c.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg","aria-hidden":!0,x:"0px",y:"0px",viewBox:"0 0 100 100",width:"15",height:"15",className:"__dumi-default-external-link-icon"},c.a.createElement("path",{fill:"currentColor",d:"M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"}),c.a.createElement("polygon",{fill:"currentColor",points:"45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"})))))))}},YTC0:function(e,n,l){e.exports=l.p+"static/console-compilation.8d98d6bd.png"},eKZL:function(e,n,l){e.exports=l.p+"static/chrome-debugger.e33a45ea.jpeg"},j9jy:function(e,n,l){e.exports=l.p+"static/webpack-compile-workflow.914d192d.jpeg"}}]);