<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"
    />
    <link rel="shortcut icon" type="image/x-icon" href="./favicon.ico" />
    <link rel="stylesheet" href="/webpack-guidebook/umi.css" />
    <script>
      window.routerBase = "/webpack-guidebook/";
    </script>
    <script>
      //! umi version: 3.2.20
    </script>
    <title>Compiler</title>
  
</head>
  <body>
    <div id="root"><div class="__dumi-default-layout" data-show-sidemenu="true" data-show-slugs="true" data-site-mode="true" data-gapless="false"><div class="__dumi-default-navbar" data-mode="site"><button class="__dumi-default-navbar-toggle"></button><a class="__dumi-default-navbar-logo" style="background-image:url(&#x27;http://img.mrsingsing.com/webpack-guidebook-favicon.svg&#x27;)" href="/webpack-guidebook//">Webpack Guidebook</a><nav><div class="__dumi-default-search"><input type="search" class="__dumi-default-search-input" value=""/><ul></ul></div><a href="/webpack-guidebook//basic-summary">基本综述</a><a aria-current="page" class="active" href="/webpack-guidebook//principle-analysis">原理分析</a><a href="/webpack-guidebook//best-practice">最佳实践</a><a target="_blank" rel="noopener noreferrer" href="https://github.com/tsejx/webpack-guidebook">Github<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div><div class="__dumi-default-menu" data-mode="site"><div class="__dumi-default-menu-inner"><div class="__dumi-default-menu-header"><a class="__dumi-default-menu-logo" style="background-image:url(&#x27;http://img.mrsingsing.com/webpack-guidebook-favicon.svg&#x27;)" href="/webpack-guidebook//"></a><h1>Webpack Guidebook</h1><p>Webpack 完全知识体系</p></div><div class="__dumi-default-menu-mobile-area"><ul class="__dumi-default-menu-nav-list"><li><a href="/webpack-guidebook//basic-summary">基本综述</a></li><li><a aria-current="page" class="active" href="/webpack-guidebook//principle-analysis">原理分析</a></li><li><a href="/webpack-guidebook//best-practice">最佳实践</a></li><li><a target="_blank" rel="noopener noreferrer" href="https://github.com/tsejx/webpack-guidebook">Github<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div><ul class="__dumi-default-menu-list"><li><a href="/webpack-guidebook//principle-analysis/babel">Babel</a></li><li><a href="/webpack-guidebook//principle-analysis/operational-principle">工作原理</a><ul><li><a href="/webpack-guidebook//principle-analysis/operational-principle/file-watch"><span>文件监听</span></a></li><li><a href="/webpack-guidebook//principle-analysis/operational-principle/hot-module-replacement"><span>模块热更新</span></a></li><li><a href="/webpack-guidebook//principle-analysis/operational-principle/filenames-hashes"><span>文件指纹策略</span></a></li><li><a href="/webpack-guidebook//principle-analysis/operational-principle/tree-shaking"><span>Tree Shaking</span></a></li><li><a href="/webpack-guidebook//principle-analysis/operational-principle/scope-hoisting"><span>作用域提升</span></a></li><li><a href="/webpack-guidebook//principle-analysis/operational-principle/sourcemap"><span>SourceMap</span></a></li></ul></li><li><a aria-current="page" class="active" href="/webpack-guidebook//principle-analysis/implementation-principle">底层原理</a><ul><li><a href="/webpack-guidebook//principle-analysis/implementation-principle/workflow"><span>构建流程</span></a></li><li><a href="/webpack-guidebook//principle-analysis/implementation-principle/simple-implementation"><span>简易实现</span></a></li><li><a href="/webpack-guidebook//principle-analysis/implementation-principle/source-code-analysis"><span>源码分析</span></a></li><li><a href="/webpack-guidebook//principle-analysis/implementation-principle/tapable"><span>Tapable</span></a></li><li><a aria-current="page" class="active" href="/webpack-guidebook//principle-analysis/implementation-principle/compiler"><span>Compiler</span></a></li><li><a href="/webpack-guidebook//principle-analysis/implementation-principle/compilation"><span>Compilation</span></a></li><li><a href="/webpack-guidebook//principle-analysis/implementation-principle/loader"><span>Loader 机制</span></a></li><li><a href="/webpack-guidebook//principle-analysis/implementation-principle/plugin"><span>Plugin 机制</span></a></li><li><a href="/webpack-guidebook//principle-analysis/implementation-principle/ast"><span>抽象语法树</span></a></li></ul></li></ul></div></div><ul class="__dumi-default-layout-toc" role="slug-list"><li title="MultiCompiler" data-depth="2" class=""><a href="/webpack-guidebook//principle-analysis/implementation-principle/compiler#multicompiler"><span>MultiCompiler</span></a></li><li title="事件钩子" data-depth="2" class=""><a href="/webpack-guidebook//principle-analysis/implementation-principle/compiler#事件钩子"><span>事件钩子</span></a></li></ul><div class="__dumi-default-layout-content"><div class="markdown"><h1 id="compiler"><a aria-hidden="true" href="#compiler"><span class="icon icon-link"></span></a>Compiler</h1><p>Webpack 的 Compiler 模块是 <strong>主引擎</strong>，它通过 Webpack CLI 或 Webpack API 或 Webpack 配置文件传递的所有选项，创建出一个 compilation 实例。</p><p>它通过 Webpack API 下 Webpack.Compiler 的导出。</p><p>Webpack 使用它来实例化 compiler，然后调用 <code>run</code> 方法。下面是一个可以使用 Compiler 简单示例。事实上，这与 Webpack 自身是如何调用它非常接近。</p><p>🌰 <strong>官方示例：</strong></p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="// 可以从 webpack package 中 import 导入
import { Compiler } from &#x27;webpack&#x27;;

// 创建一个新的 compiler 实例
const compiler = new Compiler();

// 填充所有必备的 options 选项
compiler.options = {
  // ...
};

// 创建一个插件
class LogPlugin {
  apply(compiler) {
    compiler.plugin(&#x27;should-emit&#x27;, compilation =&gt; {
      console.log(&#x27;should I emit?&#x27;);
      return true;
    });
  }
}

// 将 compiler 应用到插件中
new LogPlugin().apply(compiler);

/* 添加其他支持插件 */

// 运行结束后执行回调
const callback = (err, stats) =&gt; {
  console.log(&#x27;Compiler 已经完成执行&#x27;);
  // 显示 stats
};

// compiler 的 run 调用，并传入 callback
compiler.run(callback);
" data-status="copy"></button><div class="token-line"><span class="token comment">// 可以从 webpack package 中 import 导入</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword module">import</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> </span><span class="token maybe-class-name">Compiler</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token keyword module">from</span><span class="token plain"> </span><span class="token string">&#x27;webpack&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment">// 创建一个新的 compiler 实例</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">const</span><span class="token plain"> compiler </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword">new</span><span class="token plain"> </span><span class="token class-name">Compiler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment">// 填充所有必备的 options 选项</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">compiler</span><span class="token punctuation">.</span><span class="token property-access">options</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token comment">// ...</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment">// 创建一个插件</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">class</span><span class="token plain"> </span><span class="token class-name">LogPlugin</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token parameter">compiler</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    compiler</span><span class="token punctuation">.</span><span class="token method function property-access">plugin</span><span class="token punctuation">(</span><span class="token string">&#x27;should-emit&#x27;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token parameter">compilation</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">&#x27;should I emit?&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token keyword">return</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment">// 将 compiler 应用到插件中</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">new</span><span class="token plain"> </span><span class="token class-name">LogPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">apply</span><span class="token punctuation">(</span><span class="token plain">compiler</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment">/* 添加其他支持插件 */</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment">// 运行结束后执行回调</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">const</span><span class="token plain"> </span><span class="token function-variable function">callback</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token parameter punctuation">,</span><span class="token parameter"> stats</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">&#x27;Compiler 已经完成执行&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token comment">// 显示 stats</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment">// compiler 的 run 调用，并传入 callback</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">compiler</span><span class="token punctuation">.</span><span class="token method function property-access">run</span><span class="token punctuation">(</span><span class="token plain">callback</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p><code>Compiler</code> 也是我们所说的 <code>Tapable</code> 实例。通过这种实现机制，我们可以理解为，它混合（mix）了 <code>Tapable</code> 类，来使实例也具备 <strong>注册</strong> 和 <strong>调用插件</strong> 功能。大多数面向用户的插件，要首先在 <code>Compiler</code> 上注册。Compiler 运行机制可以被提取为以下要点：</p><ul><li>通常有一个 Compiler 的主实例。可以创建子 <code>compilers</code> 来委托特定任务。</li><li>创建 <code>compiler</code> 的多数复杂度，在于为它填充所有相关的 <code>options</code> 选项。</li><li>Webpack 通过 <code>WebpackOptionsDefaulter</code> 和 <code>WebpackOptionsApply</code>，来专门为 <code>Compiler</code> 提供所需的所有 <strong>初始数据</strong>。</li><li><code>Compiler</code> 是一个执行最简功能，来保证生命周期运行的函数。它把所有的 <strong>加载（loading）</strong> / <strong>打包（bundling）</strong> / <strong>写入（writing）</strong> 工作委托给各种插件。</li><li><code>new LogPlugin(args).apply(compiler)</code> 将插件注册到 <code>Compiler</code> 生命周期中的任何特定钩子事件。</li><li><code>Compiler</code> 暴露 <code>run</code> 方法，它启动了 Webpack 所有编译工作。在执行完成后，会调用传递给它的 <code>callback</code> 函数。记录 <code>stats</code> 和 <code>errors</code> 的所有末端工作，都在此回调函数中完成。</li></ul><h2 id="multicompiler"><a aria-hidden="true" href="#multicompiler"><span class="icon icon-link"></span></a>MultiCompiler</h2><p>MultiCompiler 模块允许 Webpack 在单个 compiler 中运行多个配置。如果 Webpack 的 Node.js API 中的 <code>options</code> 参数，是一个由 <code>options</code> 构成的数组，则 Webpack 会对其应用单个 <code>compiler</code>，并在所有 <code>compiler</code> 执行结束时，调用 <code>callback</code> 方法。</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="const Webpack = require(&#x27;webpack&#x27;);

const config1 = {
  entry: &#x27;./index1.js&#x27;,
  output: {
    filename: &#x27;bundle1.js&#x27;,
  },
};

const config2 = {
  entry: &#x27;./index2.js&#x27;,
  output: {
    filename: &#x27;bundle2.js&#x27;,
  },
};

webpack([config1, config2], (err, stats) =&gt; {
  process.stdout.write(stats.toString() + &#x27;\n&#x27;);
});
" data-status="copy"></button><div class="token-line"><span class="token keyword">const</span><span class="token plain"> </span><span class="token maybe-class-name">Webpack</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;webpack&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">const</span><span class="token plain"> config1 </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  entry</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&#x27;./index1.js&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  output</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    filename</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&#x27;bundle1.js&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">const</span><span class="token plain"> config2 </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  entry</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&#x27;./index2.js&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  output</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    filename</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&#x27;bundle2.js&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">webpack</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token plain">config1</span><span class="token punctuation">,</span><span class="token plain"> config2</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token parameter punctuation">,</span><span class="token parameter"> stats</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  process</span><span class="token punctuation">.</span><span class="token property-access">stdout</span><span class="token punctuation">.</span><span class="token method function property-access">write</span><span class="token punctuation">(</span><span class="token plain">stats</span><span class="token punctuation">.</span><span class="token method function property-access">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"> </span><span class="token string">&#x27;\n&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><h2 id="事件钩子"><a aria-hidden="true" href="#事件钩子"><span class="icon icon-link"></span></a>事件钩子</h2><p>一个参考指南，列出 Compiler 暴露的所有事件钩子。</p><table><thead><tr><th>事件名称</th><th>内容说明</th><th>参数</th><th>类型</th></tr></thead><tbody><tr><td><code>entry-option</code></td><td>-</td><td>-</td><td>basicResult</td></tr><tr><td><code>after-plugins</code></td><td>设置完一组初始化插件之后</td><td><code>compiler</code></td><td>sync 同步</td></tr><tr><td><code>after-resolvers</code></td><td>设置完 resolvers 之后</td><td><code>compiler</code></td><td>sync 同步</td></tr><tr><td><code>environment</code></td><td>-</td><td>-</td><td>sync 同步</td></tr><tr><td><code>after-environment</code></td><td>环境设置完成</td><td>-</td><td>sync 同步</td></tr><tr><td><code>before-run</code></td><td><code>compiler.run()</code> 开始</td><td><code>compiler</code></td><td>async 异步</td></tr><tr><td><code>run</code></td><td>在读取记录之前</td><td><code>compiler</code></td><td>async 异步</td></tr><tr><td><code>watch-run</code></td><td>在开始编译之前，watch 之后</td><td><code>compiler</code></td><td>async 异步</td></tr><tr><td><code>normal-module-factory</code></td><td>创建出一个 <code>NormalModuleFactory</code> 之后</td><td><code>normalModuleFactory</code></td><td>sync 同步</td></tr><tr><td><code>context-module-factory</code></td><td>创建出一个 <code>ContextModuleFactory</code> 之后</td><td><code>contextModuleFactory</code></td><td>sync 同步</td></tr><tr><td><code>before-compile</code></td><td>compilation 的参数已创建</td><td><code>compilationParams</code></td><td>async 异步</td></tr><tr><td><code>compile</code></td><td>在创建新 compilation 之前</td><td><code>compilationParams</code></td><td>sync 同步</td></tr><tr><td><code>this-compilation</code></td><td>在触发 <code>compilation</code> 事件之前</td><td><code>compilation</code></td><td>sync 同步</td></tr><tr><td><code>compilation</code></td><td>compilation 创建完成</td><td><code>compilation</code></td><td>sync 同步</td></tr><tr><td><code>make</code></td><td>-</td><td><code>compilation</code></td><td>parallel 平行</td></tr><tr><td><code>after-compile</code></td><td>-</td><td><code>compilation</code></td><td>async 异步</td></tr><tr><td><code>should-emit</code></td><td>此时可以返回 true/false</td><td><code>compilation</code></td><td>bailResult</td></tr><tr><td><code>need-additional-pass</code></td><td>-</td><td>-</td><td>bailResult</td></tr><tr><td><code>emit</code></td><td>在生成资源并输出到目录之前</td><td><code>compilation</code></td><td>async 异步</td></tr><tr><td><code>after-emit</code></td><td>在生成资源并输出到目录之后</td><td><code>compilation</code></td><td>async 异步</td></tr><tr><td><code>done</code></td><td>完成编译</td><td><code>stats</code></td><td>sync 同步</td></tr><tr><td><code>failed</code></td><td>编译失败</td><td><code>error</code></td><td>sync 同步</td></tr><tr><td><code>invalid</code></td><td>在无效的 watch 编译之后</td><td><code>fileName</code>、<code>changeTime</code></td><td>sync 同步</td></tr><tr><td><code>watch-close</code></td><td>在停止 watch 编译之后</td><td>-</td><td>sync 同步</td></tr></tbody></table><p>使用方法：</p><p>下面是一个异步的 <code>emit</code> 事件处理函数的示例：</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="compiler.plugin(&#x27;emit&#x27;, function(compilation, callback) {
  // 执行一些异步...
  setTimeout(function() {
    console.log(&#x27;异步运行完成...&#x27;);
    callback();
  }, 1000);
});
" data-status="copy"></button><div class="token-line"><span class="token plain">compiler</span><span class="token punctuation">.</span><span class="token method function property-access">plugin</span><span class="token punctuation">(</span><span class="token string">&#x27;emit&#x27;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">compilation</span><span class="token parameter punctuation">,</span><span class="token parameter"> callback</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token comment">// 执行一些异步...</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">&#x27;异步运行完成...&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><hr/><p><strong>参考资料：</strong></p><ul><li><a href="https://webpack.docschina.org/api/compiler" target="_blank" rel="noopener noreferrer">📖 Webpack 中文官网：Compiler<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a href="https://www.webpackjs.com/api/compiler-hooks/" target="_blank" rel="noopener noreferrer">📖 Compiler 模块钩子<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a href="https://imweb.io/topic/5da1397aaf03a41f046a8df1" target="_blank" rel="noopener noreferrer">📝 Webpack 源码阅读之 Compiler（2019-10-12）<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div><div class="__dumi-default-layout-footer-meta"><a target="_blank" rel="noopener noreferrer" href="https://github.com/tsejx/Webpack-Guidebook/edit/master/docs/principle-analysis/implementation-principle/compiler.md">Edit this doc on GitHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><span data-updated-text="Last Update: ">9/18/2020, 10:19:07 AM</span></div></div></div></div>
	<script>
  window.g_useSSR = true;
  window.g_initialProps = {};
	</script>

    <script src="/webpack-guidebook/umi.js"></script>
    <script src="/webpack-guidebook/docs__principle-analysis__implementation-principle__compiler.md.js"></script>
  </body>
</html>
